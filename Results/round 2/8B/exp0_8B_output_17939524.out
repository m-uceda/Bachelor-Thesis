Tue Jun 17 04:38:32 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.35.05              Driver Version: 560.35.05      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  |   00000000:CA:00.0 Off |                    0 |
| N/A   35C    P0             36W /  250W |       1MiB /  40960MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
ðŸ¦¥ Unsloth: Will patch your computer to enable 2x faster free finetuning.
ðŸ¦¥ Unsloth Zoo will now patch everything to make training faster!
INFO 06-17 04:43:06 __init__.py:207] Automatically detected platform cuda.
[W617 04:43:23.819878476 CUDAAllocatorConfig.h:28] Warning: expandable_segments not supported on this platform (function operator())
==((====))==  Unsloth 2025.6.1: Fast Llama patching. Transformers: 4.52.4. vLLM: 0.7.3.
   \\   /|    NVIDIA A100-PCIE-40GB. Num GPUs = 1. Max memory: 39.496 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.5.1+cu124. CUDA: 8.0. CUDA Toolkit: 12.4. Triton: 3.1.0
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.28.post3. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Unsloth: vLLM loading unsloth/meta-llama-3.1-8b-instruct-unsloth-bnb-4bit with actual GPU utilization = 59.31%
Unsloth: Your GPU has CUDA compute capability 8.0 with VRAM = 39.5 GB.
Unsloth: Using conservativeness = 1.0. Chunked prefill tokens = 4024. Num Sequences = 288.
Unsloth: vLLM's KV Cache can use up to 17.25 GB. Also swap space = 6 GB.
INFO 06-17 04:43:44 config.py:549] This model supports multiple tasks: {'classify', 'generate', 'score', 'reward', 'embed'}. Defaulting to 'generate'.
WARNING 06-17 04:43:49 cuda.py:95] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
Unsloth: vLLM Bitsandbytes config using kwargs = {'load_in_8bit': False, 'load_in_4bit': True, 'bnb_4bit_compute_dtype': 'bfloat16', 'bnb_4bit_quant_storage': 'uint8', 'bnb_4bit_quant_type': 'nf4', 'bnb_4bit_use_double_quant': True, 'llm_int8_enable_fp32_cpu_offload': False, 'llm_int8_has_fp16_weight': False, 'llm_int8_skip_modules': ['lm_head', 'multi_modal_projector', 'merger', 'modality_projection', 'model.layers.1.mlp'], 'llm_int8_threshold': 6.0}
INFO 06-17 04:43:49 llm_engine.py:234] Initializing a V0 LLM engine (v0.7.3) with config: model='unsloth/meta-llama-3.1-8b-instruct-unsloth-bnb-4bit', speculative_config=None, tokenizer='unsloth/meta-llama-3.1-8b-instruct-unsloth-bnb-4bit', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=4024, download_dir=None, load_format=LoadFormat.BITSANDBYTES, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=bitsandbytes, enforce_eager=True, kv_cache_dtype=auto,  device_config=cuda:0, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=unsloth/meta-llama-3.1-8b-instruct-unsloth-bnb-4bit, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=False, use_async_output_proc=False, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"level":0,"backend":"inductor","splitting_ops":[],"use_inductor":true,"compile_sizes":[],"inductor_compile_config":{"debug":false,"dce":true,"coordinate_descent_tuning":true,"trace.enabled":false,"trace.graph_diagram":false,"triton.cudagraphs":true,"compile_threads":48,"max_autotune":false,"disable_progress":false,"verbose_progress":true},"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[],"max_capture_size":0}, use_cached_outputs=False, 
INFO 06-17 04:43:52 cuda.py:229] Using Flash Attention backend.
INFO 06-17 04:43:52 model_runner.py:1110] Starting to load model unsloth/meta-llama-3.1-8b-instruct-unsloth-bnb-4bit...
INFO 06-17 04:43:54 loader.py:1089] Loading weights with BitsAndBytes quantization.  May take a while ...
INFO 06-17 04:43:55 weight_utils.py:254] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:08<00:00,  8.36s/it]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:08<00:00,  8.36s/it]

Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:02<00:00,  2.52s/it]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:02<00:00,  2.52s/it]

INFO 06-17 04:44:06 model_runner.py:1115] Loading model weights took 5.5976 GB
INFO 06-17 04:44:07 punica_selector.py:18] Using PunicaWrapperGPU.
INFO 06-17 04:44:16 worker.py:267] Memory profiling takes 9.07 seconds
INFO 06-17 04:44:16 worker.py:267] the current vLLM instance can use total_gpu_memory (39.50GiB) x gpu_memory_utilization (0.59) = 23.43GiB
INFO 06-17 04:44:16 worker.py:267] model weights take 5.60GiB; non_torch_memory takes 0.09GiB; PyTorch activation peak memory takes 1.36GiB; the rest of the memory reserved for KV Cache is 16.38GiB.
INFO 06-17 04:44:16 executor_base.py:111] # cuda blocks: 8384, # CPU blocks: 3072
INFO 06-17 04:44:16 executor_base.py:116] Maximum concurrency for 4024 tokens per request: 33.34x
INFO 06-17 04:44:19 llm_engine.py:436] init engine (profile, create kv cache, warmup model) took 12.19 seconds
Unsloth: Just some info: will skip parsing ['pre_feedforward_layernorm', 'q_norm', 'k_norm', 'post_feedforward_layernorm']
Unsloth: Just some info: will skip parsing ['pre_feedforward_layernorm', 'q_norm', 'k_norm', 'post_feedforward_layernorm']
Unsloth 2025.6.1 patched 32 layers with 32 QKV layers, 32 O layers and 32 MLP layers.
Dataset distribution:
----------------------------------------
Problem Type   Train     Test      Total     Train %   
----------------------------------------
3-option       240       60        300       80.0%
5-option       400       100       500       80.0%
7-option       560       140       700       80.0%
----------------------------------------
Overall        1200      300       1500      80.0%
Processing method: prolog
Processing sample logical_deduction_36 (iteration 0) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:36<00:00, 36.07s/it, est. speed input: 63.04 toks/s, output: 13.11 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:36<00:00, 36.08s/it, est. speed input: 63.04 toks/s, output: 13.11 toks/s]
Prolog output: E
Completed sample logical_deduction_36 (iteration 0) for method prolog
Processing sample logical_deduction_331 (iteration 1) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:37<00:00, 37.44s/it, est. speed input: 60.93 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:37<00:00, 37.44s/it, est. speed input: 60.93 toks/s, output: 13.57 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue5, 1)), context(/(solve, 1), _46))'.
Completed sample logical_deduction_331 (iteration 1) for method prolog
Processing sample logical_deduction_349 (iteration 2) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_349: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 130, in _apply_4bit_weight
    current_index += output_size
    ^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_349 (iteration 2) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 130, in _apply_4bit_weight
    current_index += output_size
    ^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:20<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_70 (iteration 3) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:20<00:20, 20.77s/it, est. speed input: 110.41 toks/s, output: 23.93 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:37<00:00, 18.31s/it, est. speed input: 122.33 toks/s, output: 25.48 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:37<00:00, 18.68s/it, est. speed input: 122.33 toks/s, output: 25.48 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(type_error(integer, -(5, 1)), _5444)'.
Completed sample logical_deduction_70 (iteration 3) for method prolog
Processing sample logical_deduction_136 (iteration 4) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_136: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 128, in _apply_4bit_weight
    bf_x, qweight[offsets[i]:offsets[i + 1]].t(), quant_states[i])
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_136 (iteration 4) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 128, in _apply_4bit_weight
    bf_x, qweight[offsets[i]:offsets[i + 1]].t(), quant_states[i])
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_343 (iteration 5) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.72s/it, est. speed input: 152.82 toks/s, output: 29.27 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:39<00:00, 20.69s/it, est. speed input: 114.47 toks/s, output: 23.47 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:39<00:00, 19.80s/it, est. speed input: 114.47 toks/s, output: 23.47 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_343 (iteration 5) for method prolog
Processing sample logical_deduction_107 (iteration 6) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:38<00:00, 38.76s/it, est. speed input: 59.19 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:38<00:00, 38.76s/it, est. speed input: 59.19 toks/s, output: 13.60 toks/s]
Prolog output: C
Completed sample logical_deduction_107 (iteration 6) for method prolog
Processing sample logical_deduction_181 (iteration 7) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.06s/it, est. speed input: 65.35 toks/s, output: 13.49 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.06s/it, est. speed input: 65.35 toks/s, output: 13.49 toks/s]
Prolog output: D
Completed sample logical_deduction_181 (iteration 7) for method prolog
Processing sample logical_deduction_189 (iteration 8) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.64s/it, est. speed input: 66.14 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.64s/it, est. speed input: 66.14 toks/s, output: 13.57 toks/s]
Prolog output: A
Completed sample logical_deduction_189 (iteration 8) for method prolog
Processing sample logical_deduction_83 (iteration 9) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:29<00:00, 29.84s/it, est. speed input: 75.07 toks/s, output: 13.47 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:29<00:00, 29.84s/it, est. speed input: 75.07 toks/s, output: 13.47 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:16:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:17:
Warning:    Singleton variables: [Len]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(type_error(integer, -(_38, 2)), _28)'.
Completed sample logical_deduction_83 (iteration 9) for method prolog
Processing sample logical_deduction_186 (iteration 10) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_186: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 130, in _apply_4bit_weight
    current_index += output_size
    ^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_186 (iteration 10) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 130, in _apply_4bit_weight
    current_index += output_size
    ^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_325 (iteration 11) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:20<00:20, 20.85s/it, est. speed input: 110.05 toks/s, output: 24.02 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:37<00:00, 18.17s/it, est. speed input: 123.49 toks/s, output: 25.68 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:37<00:00, 18.58s/it, est. speed input: 123.49 toks/s, output: 25.68 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(type_error(integer, -(5, 1)), _1706)'.
Completed sample logical_deduction_325 (iteration 11) for method prolog
Processing sample logical_deduction_232 (iteration 12) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_232: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 90, in forward
    x, _ = self.gate_up_proj(x)
           ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 265, in add_lora_linear
    self.add_shrink(buffer, x, lora_a_stacked, scale, **kwargs)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 127, in add_shrink
    self._apply_shrink_decode(y[slice_idx], x,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 56, in _apply_shrink_decode
    def _apply_shrink_decode(
    
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_232 (iteration 12) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 90, in forward
    x, _ = self.gate_up_proj(x)
           ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 265, in add_lora_linear
    self.add_shrink(buffer, x, lora_a_stacked, scale, **kwargs)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 127, in add_shrink
    self._apply_shrink_decode(y[slice_idx], x,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 56, in _apply_shrink_decode
    def _apply_shrink_decode(
    
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:20<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_54 (iteration 13) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:12<00:12, 12.36s/it, est. speed input: 181.08 toks/s, output: 33.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:41<00:00, 22.13s/it, est. speed input: 109.30 toks/s, output: 22.75 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:41<00:00, 20.66s/it, est. speed input: 109.30 toks/s, output: 22.75 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:17:
Warning:    Singleton variables: [Len]
Prolog output: B
Completed sample logical_deduction_54 (iteration 13) for method prolog
Processing sample logical_deduction_47 (iteration 14) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:39<00:00, 39.62s/it, est. speed input: 57.70 toks/s, output: 13.63 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:39<00:00, 39.62s/it, est. speed input: 57.70 toks/s, output: 13.63 toks/s]
Prolog output: A
Completed sample logical_deduction_47 (iteration 14) for method prolog
Processing sample logical_deduction_51 (iteration 15) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.90s/it, est. speed input: 66.04 toks/s, output: 13.64 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.90s/it, est. speed input: 66.04 toks/s, output: 13.64 toks/s]
Prolog output: B
Completed sample logical_deduction_51 (iteration 15) for method prolog
Processing sample logical_deduction_78 (iteration 16) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.22s/it, est. speed input: 66.95 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.22s/it, est. speed input: 66.95 toks/s, output: 13.62 toks/s]
Prolog output: E
Completed sample logical_deduction_78 (iteration 16) for method prolog
Processing sample logical_deduction_44 (iteration 17) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.51s/it, est. speed input: 64.33 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.51s/it, est. speed input: 64.33 toks/s, output: 13.60 toks/s]
Prolog output: B
Completed sample logical_deduction_44 (iteration 17) for method prolog
Processing sample logical_deduction_148 (iteration 18) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:32<00:00, 32.20s/it, est. speed input: 69.70 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:32<00:00, 32.20s/it, est. speed input: 69.70 toks/s, output: 13.60 toks/s]
Prolog output: A
Completed sample logical_deduction_148 (iteration 18) for method prolog
Processing sample logical_deduction_395 (iteration 19) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:40<00:00, 40.59s/it, est. speed input: 56.61 toks/s, output: 13.55 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:40<00:00, 40.59s/it, est. speed input: 56.61 toks/s, output: 13.55 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_395 (iteration 19) for method prolog
Processing sample logical_deduction_116 (iteration 20) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:36<00:00, 36.49s/it, est. speed input: 62.59 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:36<00:00, 36.49s/it, est. speed input: 62.59 toks/s, output: 13.62 toks/s]
Prolog output: E
Completed sample logical_deduction_116 (iteration 20) for method prolog
Processing sample logical_deduction_338 (iteration 21) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:30<00:00, 30.04s/it, est. speed input: 74.68 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:30<00:00, 30.04s/it, est. speed input: 74.68 toks/s, output: 13.58 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:14:
Warning:    Singleton variables: [Last]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:16:
Warning:    Singleton variables: [Last]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [Last]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:20:
Warning:    Singleton variables: [Last]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:21:
Warning:    Singleton variables: [Last]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:22:
Warning:    Singleton variables: [Last]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:23:
Warning:    Singleton variables: [Last]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(type_error(integer, -(_10930, 1)), _10920)'.
Completed sample logical_deduction_338 (iteration 21) for method prolog
Processing sample logical_deduction_23 (iteration 22) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_23: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 90, in forward
    x, _ = self.gate_up_proj(x)
           ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 265, in add_lora_linear
    self.add_shrink(buffer, x, lora_a_stacked, scale, **kwargs)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 127, in add_shrink
    self._apply_shrink_decode(y[slice_idx], x,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 63, in _apply_shrink_decode
    bgmv_shrink(x, w_t_all, y, self.token_lora_indices, scale)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/ops/triton_ops/bgmv_shrink.py", line 127, in _bgmv_shrink
    _bgmv_shrink_kernel[grid](
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/runtime/jit.py", line 345, in <lambda>
    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/runtime/jit.py", line 618, in run
    bound_args, sig_and_spec, constexpr_vals, non_constexpr_vals, excess_kwargs = self.binder(*args, **kwargs)
                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in dynamic_func
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/runtime/jit.py", line 297, in compute_spec_key
    if hasattr(v, "data_ptr") and (v.data_ptr() % 16 == 0):
                                   ^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_23 (iteration 22) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 90, in forward
    x, _ = self.gate_up_proj(x)
           ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 265, in add_lora_linear
    self.add_shrink(buffer, x, lora_a_stacked, scale, **kwargs)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 127, in add_shrink
    self._apply_shrink_decode(y[slice_idx], x,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 63, in _apply_shrink_decode
    bgmv_shrink(x, w_t_all, y, self.token_lora_indices, scale)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/ops/triton_ops/bgmv_shrink.py", line 127, in _bgmv_shrink
    _bgmv_shrink_kernel[grid](
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/runtime/jit.py", line 345, in <lambda>
    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/runtime/jit.py", line 618, in run
    bound_args, sig_and_spec, constexpr_vals, non_constexpr_vals, excess_kwargs = self.binder(*args, **kwargs)
                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in dynamic_func
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/runtime/jit.py", line 297, in compute_spec_key
    if hasattr(v, "data_ptr") and (v.data_ptr() % 16 == 0):
                                   ^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:20<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_35 (iteration 23) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:19<00:19, 19.04s/it, est. speed input: 119.81 toks/s, output: 25.32 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:38<00:00, 19.13s/it, est. speed input: 119.92 toks/s, output: 24.96 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:38<00:00, 19.11s/it, est. speed input: 119.92 toks/s, output: 24.96 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue5, 1)), context(/(solve, 1), _12574))'.
Completed sample logical_deduction_35 (iteration 23) for method prolog
Processing sample logical_deduction_360 (iteration 24) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_360: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 207, in forward
    output, _ = self.o_proj(attn_output)
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 870, in forward
    output_parallel = self.apply(input_parallel)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 127, in _apply_4bit_weight
    out[:, current_index:current_index + output_size] = matmul_4bit(
                                                        ^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py", line 388, in matmul_4bit
    out = F.gemv_4bit(A, B.t(), out, state=quant_state)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 1724, in gemv_4bit
    return torch.ops.bitsandbytes.gemv_4bit.default(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 716, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/library.py", line 566, in func_no_dynamo
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/backends/cuda/ops.py", line 415, in _
    out = torch.empty(shape, device=A.device, dtype=A.dtype)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_360 (iteration 24) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 207, in forward
    output, _ = self.o_proj(attn_output)
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 870, in forward
    output_parallel = self.apply(input_parallel)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 127, in _apply_4bit_weight
    out[:, current_index:current_index + output_size] = matmul_4bit(
                                                        ^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py", line 388, in matmul_4bit
    out = F.gemv_4bit(A, B.t(), out, state=quant_state)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 1724, in gemv_4bit
    return torch.ops.bitsandbytes.gemv_4bit.default(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 716, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/library.py", line 566, in func_no_dynamo
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/backends/cuda/ops.py", line 415, in _
    out = torch.empty(shape, device=A.device, dtype=A.dtype)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:20<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_98 (iteration 25) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:18<00:18, 18.38s/it, est. speed input: 124.04 toks/s, output: 25.79 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:42<00:00, 21.56s/it, est. speed input: 108.14 toks/s, output: 23.77 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:42<00:00, 21.08s/it, est. speed input: 108.14 toks/s, output: 23.77 toks/s]
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:20:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:21:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:22:29: Syntax error: Operator expected
Prolog output: E
Completed sample logical_deduction_98 (iteration 25) for method prolog
Processing sample logical_deduction_295 (iteration 26) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:39<00:00, 39.30s/it, est. speed input: 58.61 toks/s, output: 13.67 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:39<00:00, 39.30s/it, est. speed input: 58.61 toks/s, output: 13.67 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue5, 1)), context(/(solve, 1), _5382))'.
Completed sample logical_deduction_295 (iteration 26) for method prolog
Processing sample logical_deduction_185 (iteration 27) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_185: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 265, in add_lora_linear
    self.add_shrink(buffer, x, lora_a_stacked, scale, **kwargs)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 127, in add_shrink
    self._apply_shrink_decode(y[slice_idx], x,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 63, in _apply_shrink_decode
    bgmv_shrink(x, w_t_all, y, self.token_lora_indices, scale)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/ops/triton_ops/bgmv_shrink.py", line 114, in _bgmv_shrink
    assert lora_a_weights.is_contiguous()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_185 (iteration 27) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 265, in add_lora_linear
    self.add_shrink(buffer, x, lora_a_stacked, scale, **kwargs)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 127, in add_shrink
    self._apply_shrink_decode(y[slice_idx], x,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 63, in _apply_shrink_decode
    bgmv_shrink(x, w_t_all, y, self.token_lora_indices, scale)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/ops/triton_ops/bgmv_shrink.py", line 114, in _bgmv_shrink
    assert lora_a_weights.is_contiguous()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_316 (iteration 28) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:18<00:18, 18.17s/it, est. speed input: 126.66 toks/s, output: 25.98 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:36<00:00, 18.14s/it, est. speed input: 125.97 toks/s, output: 25.36 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:36<00:00, 18.14s/it, est. speed input: 125.97 toks/s, output: 25.36 toks/s]
Prolog output: B
Completed sample logical_deduction_316 (iteration 28) for method prolog
Processing sample logical_deduction_321 (iteration 29) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:31<00:00, 31.21s/it, est. speed input: 71.90 toks/s, output: 13.68 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:31<00:00, 31.21s/it, est. speed input: 71.90 toks/s, output: 13.68 toks/s]
Prolog output: B
Completed sample logical_deduction_321 (iteration 29) for method prolog
Processing sample logical_deduction_24 (iteration 30) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.51s/it, est. speed input: 64.48 toks/s, output: 13.66 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.51s/it, est. speed input: 64.48 toks/s, output: 13.66 toks/s]
Prolog output: E
Completed sample logical_deduction_24 (iteration 30) for method prolog
Processing sample logical_deduction_150 (iteration 31) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.03s/it, est. speed input: 66.12 toks/s, output: 13.67 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.03s/it, est. speed input: 66.12 toks/s, output: 13.67 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_150 (iteration 31) for method prolog
Processing sample logical_deduction_282 (iteration 32) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:33<00:00, 33.94s/it, est. speed input: 67.12 toks/s, output: 13.64 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:33<00:00, 33.94s/it, est. speed input: 67.12 toks/s, output: 13.64 toks/s]
Prolog output: C
Completed sample logical_deduction_282 (iteration 32) for method prolog
Processing sample logical_deduction_40 (iteration 33) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:33<00:00, 33.43s/it, est. speed input: 68.18 toks/s, output: 13.67 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:33<00:00, 33.43s/it, est. speed input: 68.18 toks/s, output: 13.67 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_40 (iteration 33) for method prolog
Processing sample logical_deduction_193 (iteration 34) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:38<00:00, 38.69s/it, est. speed input: 59.37 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:38<00:00, 38.69s/it, est. speed input: 59.37 toks/s, output: 13.62 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue5, 1)), context(/(solve, 1), _2174))'.
Completed sample logical_deduction_193 (iteration 34) for method prolog
Processing sample logical_deduction_63 (iteration 35) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_63: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 92, in forward
    x, _ = self.down_proj(x)
           ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 870, in forward
    output_parallel = self.apply(input_parallel)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 266, in add_lora_linear
    self.add_expand(y,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 173, in add_expand
    self._apply_expand_decode(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 95, in _apply_expand_decode
    bgmv_expand_slice(x, w_t_all, y, self.token_lora_indices, y_offset,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/ops/triton_ops/bgmv_expand_slice.py", line 133, in _bgmv_expand_slice
    assert lora_b_weights.size(1) == 1
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_63 (iteration 35) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 92, in forward
    x, _ = self.down_proj(x)
           ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 870, in forward
    output_parallel = self.apply(input_parallel)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 266, in add_lora_linear
    self.add_expand(y,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 173, in add_expand
    self._apply_expand_decode(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 95, in _apply_expand_decode
    bgmv_expand_slice(x, w_t_all, y, self.token_lora_indices, y_offset,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/ops/triton_ops/bgmv_expand_slice.py", line 133, in _bgmv_expand_slice
    assert lora_b_weights.size(1) == 1
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_274 (iteration 36) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:16<00:16, 16.36s/it, est. speed input: 139.45 toks/s, output: 27.69 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:38<00:00, 19.93s/it, est. speed input: 118.28 toks/s, output: 24.23 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:38<00:00, 19.40s/it, est. speed input: 118.28 toks/s, output: 24.23 toks/s]
Prolog output: B
Completed sample logical_deduction_274 (iteration 36) for method prolog
Processing sample logical_deduction_235 (iteration 37) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.01s/it, est. speed input: 67.19 toks/s, output: 13.64 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.01s/it, est. speed input: 67.19 toks/s, output: 13.64 toks/s]
Prolog output: A
Completed sample logical_deduction_235 (iteration 37) for method prolog
Processing sample logical_deduction_373 (iteration 38) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:33<00:00, 33.55s/it, est. speed input: 67.81 toks/s, output: 13.56 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:33<00:00, 33.55s/it, est. speed input: 67.81 toks/s, output: 13.56 toks/s]
Prolog output: D
Completed sample logical_deduction_373 (iteration 38) for method prolog
Processing sample logical_deduction_22 (iteration 39) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:31<00:00, 31.66s/it, est. speed input: 70.79 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:31<00:00, 31.66s/it, est. speed input: 70.79 toks/s, output: 13.61 toks/s]
Prolog output: E
Completed sample logical_deduction_22 (iteration 39) for method prolog
Processing sample logical_deduction_13 (iteration 40) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.36s/it, est. speed input: 64.20 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.36s/it, est. speed input: 64.20 toks/s, output: 13.57 toks/s]
Prolog output: D
Completed sample logical_deduction_13 (iteration 40) for method prolog
Processing sample logical_deduction_135 (iteration 41) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.10s/it, est. speed input: 67.53 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.10s/it, est. speed input: 67.53 toks/s, output: 13.58 toks/s]
Prolog output: B
Completed sample logical_deduction_135 (iteration 41) for method prolog
Processing sample logical_deduction_309 (iteration 42) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:31<00:00, 31.25s/it, est. speed input: 71.81 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:31<00:00, 31.25s/it, est. speed input: 71.81 toks/s, output: 13.60 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_309 (iteration 42) for method prolog
Processing sample logical_deduction_176 (iteration 43) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:30<00:00, 30.87s/it, est. speed input: 72.56 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:30<00:00, 30.87s/it, est. speed input: 72.56 toks/s, output: 13.61 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_176 (iteration 43) for method prolog
Processing sample logical_deduction_33 (iteration 44) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.58s/it, est. speed input: 64.44 toks/s, output: 13.55 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.58s/it, est. speed input: 64.44 toks/s, output: 13.55 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue5, 1)), context(/(solve, 1), _2180))'.
Completed sample logical_deduction_33 (iteration 44) for method prolog
Processing sample logical_deduction_183 (iteration 45) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_183: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 92, in forward
    x, _ = self.down_proj(x)
           ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 871, in forward
    if self.base_layer.reduce_results and self.base_layer.tp_size > 1:
                                          ^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1918, in __getattr__
    def __getattr__(self, name: str) -> Any:
    
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_183 (iteration 45) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 92, in forward
    x, _ = self.down_proj(x)
           ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 871, in forward
    if self.base_layer.reduce_results and self.base_layer.tp_size > 1:
                                          ^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1918, in __getattr__
    def __getattr__(self, name: str) -> Any:
    
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_49 (iteration 46) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:22<00:22, 22.89s/it, est. speed input: 99.83 toks/s, output: 22.81 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:38<00:00, 18.63s/it, est. speed input: 118.56 toks/s, output: 25.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:38<00:00, 19.27s/it, est. speed input: 118.56 toks/s, output: 25.62 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue5, 1)), context(/(solve, 1), _3828))'.
Completed sample logical_deduction_49 (iteration 46) for method prolog
Processing sample logical_deduction_194 (iteration 47) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_194: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 207, in forward
    output, _ = self.o_proj(attn_output)
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 870, in forward
    output_parallel = self.apply(input_parallel)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 127, in _apply_4bit_weight
    out[:, current_index:current_index + output_size] = matmul_4bit(
                                                        ^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py", line 388, in matmul_4bit
    out = F.gemv_4bit(A, B.t(), out, state=quant_state)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 1710, in gemv_4bit
    absmax = dequantize_blockwise(absmax, state.state2) + state.offset
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 861, in dequantize_blockwise
    return torch.ops.bitsandbytes.dequantize_blockwise.default(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 716, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/library.py", line 566, in func_no_dynamo
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/backends/cuda/ops.py", line 245, in _
    out = torch.empty_like(A, dtype=dtype)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_194 (iteration 47) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 207, in forward
    output, _ = self.o_proj(attn_output)
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 870, in forward
    output_parallel = self.apply(input_parallel)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 127, in _apply_4bit_weight
    out[:, current_index:current_index + output_size] = matmul_4bit(
                                                        ^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py", line 388, in matmul_4bit
    out = F.gemv_4bit(A, B.t(), out, state=quant_state)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 1710, in gemv_4bit
    absmax = dequantize_blockwise(absmax, state.state2) + state.offset
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 861, in dequantize_blockwise
    return torch.ops.bitsandbytes.dequantize_blockwise.default(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 716, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/library.py", line 566, in func_no_dynamo
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/backends/cuda/ops.py", line 245, in _
    out = torch.empty_like(A, dtype=dtype)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_80 (iteration 48) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:17<00:17, 17.63s/it, est. speed input: 129.37 toks/s, output: 26.49 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:38<00:00, 19.26s/it, est. speed input: 120.52 toks/s, output: 24.71 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:38<00:00, 19.02s/it, est. speed input: 120.52 toks/s, output: 24.71 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:14:
Warning:    Singleton variables: [Len]
Prolog output: A
Completed sample logical_deduction_80 (iteration 48) for method prolog
Processing sample logical_deduction_90 (iteration 49) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.76s/it, est. speed input: 66.25 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.76s/it, est. speed input: 66.25 toks/s, output: 13.61 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:14:
Warning:    Singleton variables: [Len]
Prolog output: E
Completed sample logical_deduction_90 (iteration 49) for method prolog
Processing sample logical_deduction_172 (iteration 50) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:36<00:00, 36.47s/it, est. speed input: 62.87 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:36<00:00, 36.47s/it, est. speed input: 62.87 toks/s, output: 13.60 toks/s]
Prolog output: D
Completed sample logical_deduction_172 (iteration 50) for method prolog
Processing sample logical_deduction_390 (iteration 51) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:42<00:00, 42.59s/it, est. speed input: 53.89 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:42<00:00, 42.59s/it, est. speed input: 53.89 toks/s, output: 13.57 toks/s]
Prolog output: A
Completed sample logical_deduction_390 (iteration 51) for method prolog
Processing sample logical_deduction_110 (iteration 52) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:38<00:00, 38.50s/it, est. speed input: 59.83 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:38<00:00, 38.50s/it, est. speed input: 59.83 toks/s, output: 13.61 toks/s]
Prolog output: B
Completed sample logical_deduction_110 (iteration 52) for method prolog
Processing sample logical_deduction_79 (iteration 53) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.52s/it, est. speed input: 66.52 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.52s/it, est. speed input: 66.52 toks/s, output: 13.62 toks/s]
Prolog output: A
Completed sample logical_deduction_79 (iteration 53) for method prolog
Processing sample logical_deduction_64 (iteration 54) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.94s/it, est. speed input: 64.04 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.94s/it, est. speed input: 64.04 toks/s, output: 13.60 toks/s]
Prolog output: B
Completed sample logical_deduction_64 (iteration 54) for method prolog
Processing sample logical_deduction_174 (iteration 55) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.98s/it, est. speed input: 65.67 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.98s/it, est. speed input: 65.67 toks/s, output: 13.61 toks/s]
Prolog output: B
Completed sample logical_deduction_174 (iteration 55) for method prolog
Processing sample logical_deduction_83 (iteration 56) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:30<00:00, 30.89s/it, est. speed input: 72.52 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:30<00:00, 30.89s/it, est. speed input: 72.52 toks/s, output: 13.60 toks/s]
Prolog output: A
Completed sample logical_deduction_83 (iteration 56) for method prolog
Processing sample logical_deduction_357 (iteration 57) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:31<00:00, 31.38s/it, est. speed input: 71.75 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:31<00:00, 31.39s/it, est. speed input: 71.75 toks/s, output: 13.61 toks/s]
Prolog output: D
Completed sample logical_deduction_357 (iteration 57) for method prolog
Processing sample logical_deduction_81 (iteration 58) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:33<00:00, 33.94s/it, est. speed input: 67.80 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:33<00:00, 33.94s/it, est. speed input: 67.80 toks/s, output: 13.58 toks/s]
Prolog output: C
Completed sample logical_deduction_81 (iteration 58) for method prolog
Processing sample logical_deduction_12 (iteration 59) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:30<00:00, 30.52s/it, est. speed input: 73.46 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:30<00:00, 30.52s/it, est. speed input: 73.46 toks/s, output: 13.60 toks/s]
Prolog output: D
Completed sample logical_deduction_12 (iteration 59) for method prolog
Processing sample logical_deduction_388 (iteration 60) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:42<00:00, 42.53s/it, est. speed input: 54.10 toks/s, output: 13.43 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:42<00:00, 42.53s/it, est. speed input: 54.10 toks/s, output: 13.43 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_388 (iteration 60) for method prolog
Processing sample logical_deduction_3 (iteration 61) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.91s/it, est. speed input: 63.82 toks/s, output: 13.51 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.91s/it, est. speed input: 63.82 toks/s, output: 13.51 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_3 (iteration 61) for method prolog
Processing sample logical_deduction_45 (iteration 62) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:40<00:00, 40.54s/it, est. speed input: 56.71 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:40<00:00, 40.54s/it, est. speed input: 56.71 toks/s, output: 13.57 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue5, 1)), context(/(solve, 1), _2174))'.
Completed sample logical_deduction_45 (iteration 62) for method prolog
Processing sample logical_deduction_14 (iteration 63) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_14: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 266, in add_lora_linear
    self.add_expand(y,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 173, in add_expand
    self._apply_expand_decode(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 95, in _apply_expand_decode
    bgmv_expand_slice(x, w_t_all, y, self.token_lora_indices, y_offset,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/ops/triton_ops/bgmv_expand_slice.py", line 161, in _bgmv_expand_slice
    _bgmv_expand_slice_kernel[grid](
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/runtime/jit.py", line 345, in <lambda>
    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/runtime/jit.py", line 618, in run
    bound_args, sig_and_spec, constexpr_vals, non_constexpr_vals, excess_kwargs = self.binder(*args, **kwargs)
                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 1, in dynamic_func
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_14 (iteration 63) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 266, in add_lora_linear
    self.add_expand(y,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 173, in add_expand
    self._apply_expand_decode(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 95, in _apply_expand_decode
    bgmv_expand_slice(x, w_t_all, y, self.token_lora_indices, y_offset,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/ops/triton_ops/bgmv_expand_slice.py", line 161, in _bgmv_expand_slice
    _bgmv_expand_slice_kernel[grid](
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/runtime/jit.py", line 345, in <lambda>
    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/runtime/jit.py", line 618, in run
    bound_args, sig_and_spec, constexpr_vals, non_constexpr_vals, excess_kwargs = self.binder(*args, **kwargs)
                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 1, in dynamic_func
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_142 (iteration 64) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:23<00:23, 23.64s/it, est. speed input: 96.74 toks/s, output: 22.50 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:39<00:00, 19.14s/it, est. speed input: 115.76 toks/s, output: 25.48 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:39<00:00, 19.82s/it, est. speed input: 115.76 toks/s, output: 25.48 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue5, 1)), context(/(solve, 1), _3828))'.
Completed sample logical_deduction_142 (iteration 64) for method prolog
Processing sample logical_deduction_301 (iteration 65) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_301: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 207, in forward
    output, _ = self.o_proj(attn_output)
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 870, in forward
    output_parallel = self.apply(input_parallel)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 110, in _apply_4bit_weight
    bf_x = x.to(inference_dtype) # Originally used bfloat16
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_301 (iteration 65) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 207, in forward
    output, _ = self.o_proj(attn_output)
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 870, in forward
    output_parallel = self.apply(input_parallel)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 110, in _apply_4bit_weight
    bf_x = x.to(inference_dtype) # Originally used bfloat16
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_229 (iteration 66) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:19<00:19, 19.19s/it, est. speed input: 119.42 toks/s, output: 25.22 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:39<00:00, 19.77s/it, est. speed input: 115.99 toks/s, output: 24.69 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:39<00:00, 19.69s/it, est. speed input: 115.99 toks/s, output: 24.69 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_229 (iteration 66) for method prolog
Processing sample logical_deduction_112 (iteration 67) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:33<00:00, 33.89s/it, est. speed input: 67.59 toks/s, output: 13.63 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:33<00:00, 33.89s/it, est. speed input: 67.59 toks/s, output: 13.63 toks/s]
Prolog output: A
Completed sample logical_deduction_112 (iteration 67) for method prolog
Processing sample logical_deduction_214 (iteration 68) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:37<00:00, 37.35s/it, est. speed input: 61.26 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:37<00:00, 37.35s/it, est. speed input: 61.26 toks/s, output: 13.60 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue5, 1)), context(/(solve, 1), _8460))'.
Completed sample logical_deduction_214 (iteration 68) for method prolog
Processing sample logical_deduction_86 (iteration 69) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_86: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 265, in add_lora_linear
    self.add_shrink(buffer, x, lora_a_stacked, scale, **kwargs)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 127, in add_shrink
    self._apply_shrink_decode(y[slice_idx], x,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 63, in _apply_shrink_decode
    bgmv_shrink(x, w_t_all, y, self.token_lora_indices, scale)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_86 (iteration 69) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 265, in add_lora_linear
    self.add_shrink(buffer, x, lora_a_stacked, scale, **kwargs)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 127, in add_shrink
    self._apply_shrink_decode(y[slice_idx], x,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 63, in _apply_shrink_decode
    bgmv_shrink(x, w_t_all, y, self.token_lora_indices, scale)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_359 (iteration 70) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.22s/it, est. speed input: 157.80 toks/s, output: 30.10 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:37<00:00, 19.70s/it, est. speed input: 118.79 toks/s, output: 23.96 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:37<00:00, 18.88s/it, est. speed input: 118.79 toks/s, output: 23.96 toks/s]
Prolog output: D
Completed sample logical_deduction_359 (iteration 70) for method prolog
Processing sample logical_deduction_332 (iteration 71) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:41<00:00, 41.93s/it, est. speed input: 54.81 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:41<00:00, 41.93s/it, est. speed input: 54.81 toks/s, output: 13.59 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [Len]
Prolog output: A
Completed sample logical_deduction_332 (iteration 71) for method prolog
Processing sample logical_deduction_366 (iteration 72) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:37<00:00, 37.14s/it, est. speed input: 62.06 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:37<00:00, 37.14s/it, est. speed input: 62.06 toks/s, output: 13.60 toks/s]
Prolog output: B
Completed sample logical_deduction_366 (iteration 72) for method prolog
Processing sample logical_deduction_101 (iteration 73) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:36<00:00, 36.32s/it, est. speed input: 63.33 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:36<00:00, 36.32s/it, est. speed input: 63.33 toks/s, output: 13.60 toks/s]
Prolog output: D
Completed sample logical_deduction_101 (iteration 73) for method prolog
Processing sample logical_deduction_287 (iteration 74) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:33<00:00, 33.38s/it, est. speed input: 68.70 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:33<00:00, 33.38s/it, est. speed input: 68.70 toks/s, output: 13.57 toks/s]
Prolog output: A
Completed sample logical_deduction_287 (iteration 74) for method prolog
Processing sample logical_deduction_13 (iteration 75) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:30<00:00, 30.84s/it, est. speed input: 72.62 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:30<00:00, 30.84s/it, est. speed input: 72.62 toks/s, output: 13.62 toks/s]
Prolog output: E
Completed sample logical_deduction_13 (iteration 75) for method prolog
Processing sample logical_deduction_308 (iteration 76) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.99s/it, est. speed input: 63.76 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.99s/it, est. speed input: 63.76 toks/s, output: 13.59 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue5, 1)), context(/(solve, 1), _6656))'.
Completed sample logical_deduction_308 (iteration 76) for method prolog
Processing sample logical_deduction_258 (iteration 77) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_258: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 127, in _apply_4bit_weight
    out[:, current_index:current_index + output_size] = matmul_4bit(
                                                        ^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py", line 388, in matmul_4bit
    out = F.gemv_4bit(A, B.t(), out, state=quant_state)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 1710, in gemv_4bit
    absmax = dequantize_blockwise(absmax, state.state2) + state.offset
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 861, in dequantize_blockwise
    return torch.ops.bitsandbytes.dequantize_blockwise.default(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 716, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 630, in _fn
    prior = _maybe_set_eval_frame(callback)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 106, in _maybe_set_eval_frame
    if not justknobs_check("pytorch/compiler:enable_compiler_set_eval_frame"):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_utils_internal.py", line 271, in justknobs_check
    def justknobs_check(name: str) -> bool:
    
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_258 (iteration 77) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 127, in _apply_4bit_weight
    out[:, current_index:current_index + output_size] = matmul_4bit(
                                                        ^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py", line 388, in matmul_4bit
    out = F.gemv_4bit(A, B.t(), out, state=quant_state)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 1710, in gemv_4bit
    absmax = dequantize_blockwise(absmax, state.state2) + state.offset
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 861, in dequantize_blockwise
    return torch.ops.bitsandbytes.dequantize_blockwise.default(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 716, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 630, in _fn
    prior = _maybe_set_eval_frame(callback)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 106, in _maybe_set_eval_frame
    if not justknobs_check("pytorch/compiler:enable_compiler_set_eval_frame"):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_utils_internal.py", line 271, in justknobs_check
    def justknobs_check(name: str) -> bool:
    
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:20<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_119 (iteration 78) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:18<00:18, 18.72s/it, est. speed input: 122.38 toks/s, output: 25.48 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:34<00:00, 17.22s/it, est. speed input: 129.89 toks/s, output: 25.88 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:34<00:00, 17.45s/it, est. speed input: 129.89 toks/s, output: 25.88 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:14:
Warning:    Singleton variables: [Len]
Prolog output: D
Completed sample logical_deduction_119 (iteration 78) for method prolog
Processing sample logical_deduction_111 (iteration 79) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:41<00:00, 41.68s/it, est. speed input: 54.92 toks/s, output: 13.63 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:41<00:00, 41.68s/it, est. speed input: 54.92 toks/s, output: 13.63 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:18:
Warning:    Singleton variables: [Pos]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_111 (iteration 79) for method prolog
Processing sample logical_deduction_47 (iteration 80) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:37<00:00, 37.28s/it, est. speed input: 61.29 toks/s, output: 13.63 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:37<00:00, 37.28s/it, est. speed input: 61.29 toks/s, output: 13.63 toks/s]
Prolog output: A
Completed sample logical_deduction_47 (iteration 80) for method prolog
Processing sample logical_deduction_15 (iteration 81) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.96s/it, est. speed input: 65.71 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:34<00:00, 34.96s/it, est. speed input: 65.71 toks/s, output: 13.62 toks/s]
Prolog output: D
Completed sample logical_deduction_15 (iteration 81) for method prolog
Processing sample logical_deduction_16 (iteration 82) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:41<00:00, 41.19s/it, est. speed input: 55.69 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:41<00:00, 41.19s/it, est. speed input: 55.69 toks/s, output: 13.59 toks/s]
Prolog output: B
Completed sample logical_deduction_16 (iteration 82) for method prolog
Processing sample logical_deduction_216 (iteration 83) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:30<00:00, 30.11s/it, est. speed input: 74.44 toks/s, output: 13.68 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:30<00:00, 30.11s/it, est. speed input: 74.44 toks/s, output: 13.68 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:14:
Warning:    Singleton variables: [X,Y]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:15:
Warning:    Singleton variables: [X,Y]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:16:
Warning:    Singleton variables: [X,Y]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(nth1, 6)), context(/(clue1, 1), _9044))'.
Completed sample logical_deduction_216 (iteration 83) for method prolog
Processing sample logical_deduction_302 (iteration 84) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_302: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 206, in forward
    attn_output = self.attn(q, k, v, kv_cache, attn_metadata)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/attention/layer.py", line 190, in forward
    torch.ops.vllm.unified_attention_with_output(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/attention/layer.py", line 339, in unified_attention_with_output
    self.impl.forward(self,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/attention/backends/flash_attn.py", line 714, in forward
    torch.ops._C_cache_ops.reshape_and_cache_flash(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_302 (iteration 84) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 206, in forward
    attn_output = self.attn(q, k, v, kv_cache, attn_metadata)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/attention/layer.py", line 190, in forward
    torch.ops.vllm.unified_attention_with_output(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/attention/layer.py", line 339, in unified_attention_with_output
    self.impl.forward(self,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/attention/backends/flash_attn.py", line 714, in forward
    torch.ops._C_cache_ops.reshape_and_cache_flash(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:20<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_44 (iteration 85) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:16<00:16, 16.77s/it, est. speed input: 135.78 toks/s, output: 27.13 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:40<00:00, 20.74s/it, est. speed input: 113.33 toks/s, output: 23.80 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:40<00:00, 20.15s/it, est. speed input: 113.33 toks/s, output: 23.80 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:17:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:20:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:21:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:22:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:23:
Warning:    Singleton variables: [Len]
Prolog output: A
Completed sample logical_deduction_44 (iteration 85) for method prolog
Processing sample logical_deduction_279 (iteration 86) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:37<00:00, 37.02s/it, est. speed input: 61.78 toks/s, output: 13.67 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:37<00:00, 37.02s/it, est. speed input: 61.78 toks/s, output: 13.67 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:17:
Warning:    Singleton variables: [X]
Prolog output: D
Completed sample logical_deduction_279 (iteration 86) for method prolog
Processing sample logical_deduction_56 (iteration 87) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:39<00:00, 40.00s/it, est. speed input: 57.13 toks/s, output: 13.68 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:39<00:00, 40.00s/it, est. speed input: 57.13 toks/s, output: 13.68 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:15:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:23:
Warning:    Singleton variables: [X]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue5, 1)), context(/(solve, 1), _8414))'.
Completed sample logical_deduction_56 (iteration 87) for method prolog
Processing sample logical_deduction_96 (iteration 88) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_96: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 206, in forward
    attn_output = self.attn(q, k, v, kv_cache, attn_metadata)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/attention/layer.py", line 190, in forward
    torch.ops.vllm.unified_attention_with_output(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_96 (iteration 88) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 206, in forward
    attn_output = self.attn(q, k, v, kv_cache, attn_metadata)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/attention/layer.py", line 190, in forward
    torch.ops.vllm.unified_attention_with_output(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_346 (iteration 89) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:18<00:18, 18.70s/it, est. speed input: 121.47 toks/s, output: 25.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:39<00:00, 19.71s/it, est. speed input: 116.18 toks/s, output: 24.69 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:39<00:00, 19.56s/it, est. speed input: 116.18 toks/s, output: 24.69 toks/s]
Prolog output: A
Completed sample logical_deduction_346 (iteration 89) for method prolog
Processing sample logical_deduction_52 (iteration 90) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:36<00:00, 36.48s/it, est. speed input: 62.72 toks/s, output: 13.65 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:36<00:00, 36.48s/it, est. speed input: 62.72 toks/s, output: 13.65 toks/s]
Prolog output: C
Completed sample logical_deduction_52 (iteration 90) for method prolog
Processing sample logical_deduction_377 (iteration 91) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:38<00:00, 38.77s/it, est. speed input: 59.40 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:38<00:00, 38.77s/it, est. speed input: 59.40 toks/s, output: 13.59 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:21:
Warning:    Singleton variables: [Len,Pos]
Prolog output: A
Completed sample logical_deduction_377 (iteration 91) for method prolog
Processing sample logical_deduction_71 (iteration 92) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:39<00:00, 39.77s/it, est. speed input: 57.58 toks/s, output: 13.65 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:39<00:00, 39.77s/it, est. speed input: 57.58 toks/s, output: 13.65 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_71 (iteration 92) for method prolog
Processing sample logical_deduction_114 (iteration 93) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:36<00:00, 36.98s/it, est. speed input: 62.09 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:36<00:00, 36.98s/it, est. speed input: 62.09 toks/s, output: 13.58 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:16:
Warning:    Singleton variables: [Pos]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:17:
Warning:    Singleton variables: [Pos]
Prolog output: A
Completed sample logical_deduction_114 (iteration 93) for method prolog
Processing sample logical_deduction_125 (iteration 94) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:47<00:00, 47.59s/it, est. speed input: 48.14 toks/s, output: 13.64 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:47<00:00, 47.59s/it, est. speed input: 48.14 toks/s, output: 13.64 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue5, 1)), context(/(solve, 1), _6244))'.
Completed sample logical_deduction_125 (iteration 94) for method prolog
Processing sample logical_deduction_140 (iteration 95) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_140: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 127, in _apply_4bit_weight
    out[:, current_index:current_index + output_size] = matmul_4bit(
                                                        ^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py", line 388, in matmul_4bit
    out = F.gemv_4bit(A, B.t(), out, state=quant_state)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 1724, in gemv_4bit
    return torch.ops.bitsandbytes.gemv_4bit.default(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 716, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/library.py", line 566, in func_no_dynamo
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/backends/cuda/ops.py", line 415, in _
    out = torch.empty(shape, device=A.device, dtype=A.dtype)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_140 (iteration 95) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 127, in _apply_4bit_weight
    out[:, current_index:current_index + output_size] = matmul_4bit(
                                                        ^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py", line 388, in matmul_4bit
    out = F.gemv_4bit(A, B.t(), out, state=quant_state)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 1724, in gemv_4bit
    return torch.ops.bitsandbytes.gemv_4bit.default(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 716, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/library.py", line 566, in func_no_dynamo
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/backends/cuda/ops.py", line 415, in _
    out = torch.empty(shape, device=A.device, dtype=A.dtype)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_379 (iteration 96) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.34s/it, est. speed input: 94.56 toks/s, output: 22.14 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:35<00:00, 16.49s/it, est. speed input: 128.55 toks/s, output: 27.14 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:35<00:00, 17.67s/it, est. speed input: 128.55 toks/s, output: 27.14 toks/s]
Prolog output: A
Completed sample logical_deduction_379 (iteration 96) for method prolog
Processing sample logical_deduction_12 (iteration 97) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:37<00:00, 37.94s/it, est. speed input: 60.69 toks/s, output: 13.65 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:37<00:00, 37.94s/it, est. speed input: 60.69 toks/s, output: 13.65 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [Len]
Prolog output: A
Completed sample logical_deduction_12 (iteration 97) for method prolog
Processing sample logical_deduction_57 (iteration 98) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.24s/it, est. speed input: 64.99 toks/s, output: 13.51 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:35<00:00, 35.24s/it, est. speed input: 64.99 toks/s, output: 13.51 toks/s]
Prolog output: E
Completed sample logical_deduction_57 (iteration 98) for method prolog
Processing sample logical_deduction_327 (iteration 99) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:39<00:00, 39.19s/it, est. speed input: 58.29 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:39<00:00, 39.19s/it, est. speed input: 58.29 toks/s, output: 13.60 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:16:
Warning:    Singleton variables: [Pos]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:23:
Warning:    Singleton variables: [Pos]
Prolog output: A
Completed sample logical_deduction_327 (iteration 99) for method prolog
Processing sample logical_deduction_463 (iteration 100) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:49<00:00, 49.21s/it, est. speed input: 47.61 toks/s, output: 13.64 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:49<00:00, 49.21s/it, est. speed input: 47.61 toks/s, output: 13.64 toks/s]
Prolog output: G
Completed sample logical_deduction_463 (iteration 100) for method prolog
Processing sample logical_deduction_825 (iteration 101) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.13s/it, est. speed input: 48.89 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.13s/it, est. speed input: 48.89 toks/s, output: 13.61 toks/s]
Prolog output: A
Completed sample logical_deduction_825 (iteration 101) for method prolog
Processing sample logical_deduction_877 (iteration 102) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.06s/it, est. speed input: 43.40 toks/s, output: 13.52 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.06s/it, est. speed input: 43.40 toks/s, output: 13.52 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:21:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:23:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:25:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:26:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:28:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:30:
Warning:    Singleton variables: [Len]
Prolog output: B
Completed sample logical_deduction_877 (iteration 102) for method prolog
Processing sample logical_deduction_955 (iteration 103) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.91s/it, est. speed input: 47.62 toks/s, output: 13.66 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.91s/it, est. speed input: 47.62 toks/s, output: 13.66 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:18:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:21:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:28:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:30:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:31:
Warning:    Singleton variables: [X]
Prolog output: A
Completed sample logical_deduction_955 (iteration 103) for method prolog
Processing sample logical_deduction_216 (iteration 104) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.67s/it, est. speed input: 42.00 toks/s, output: 13.53 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.67s/it, est. speed input: 42.00 toks/s, output: 13.53 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:23:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:28:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:29:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:30:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:31:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:32:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:33:
Warning:    Singleton variables: [X]
Prolog output: B
Completed sample logical_deduction_216 (iteration 104) for method prolog
Processing sample logical_deduction_817 (iteration 105) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:46<00:00, 46.59s/it, est. speed input: 48.68 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:46<00:00, 46.59s/it, est. speed input: 48.68 toks/s, output: 13.61 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [X]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_817 (iteration 105) for method prolog
Processing sample logical_deduction_162 (iteration 106) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:52<00:00, 52.35s/it, est. speed input: 44.45 toks/s, output: 13.54 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:52<00:00, 52.35s/it, est. speed input: 44.45 toks/s, output: 13.54 toks/s]
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:26:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:27:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:28:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:29:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:30:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:31:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:32:29: Syntax error: Operator expected
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue7, 1)), context(/(solve, 1), _9202))'.
Completed sample logical_deduction_162 (iteration 106) for method prolog
Processing sample logical_deduction_465 (iteration 107) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_465: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 90, in forward
    x, _ = self.gate_up_proj(x)
           ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 265, in add_lora_linear
    self.add_shrink(buffer, x, lora_a_stacked, scale, **kwargs)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 127, in add_shrink
    self._apply_shrink_decode(y[slice_idx], x,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 63, in _apply_shrink_decode
    bgmv_shrink(x, w_t_all, y, self.token_lora_indices, scale)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_465 (iteration 107) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 90, in forward
    x, _ = self.gate_up_proj(x)
           ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 265, in add_lora_linear
    self.add_shrink(buffer, x, lora_a_stacked, scale, **kwargs)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 127, in add_shrink
    self._apply_shrink_decode(y[slice_idx], x,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 63, in _apply_shrink_decode
    bgmv_shrink(x, w_t_all, y, self.token_lora_indices, scale)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_619 (iteration 108) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:49<00:49, 49.93s/it, est. speed input: 46.93 toks/s, output: 16.48 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:05<00:00, 29.82s/it, est. speed input: 71.19 toks/s, output: 24.21 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:05<00:00, 32.84s/it, est. speed input: 71.19 toks/s, output: 24.21 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_619 (iteration 108) for method prolog
Processing sample logical_deduction_556 (iteration 109) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.30s/it, est. speed input: 45.91 toks/s, output: 13.55 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.30s/it, est. speed input: 45.91 toks/s, output: 13.55 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_556 (iteration 109) for method prolog
Processing sample logical_deduction_792 (iteration 110) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:43<00:00, 43.23s/it, est. speed input: 52.49 toks/s, output: 13.37 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:43<00:00, 43.23s/it, est. speed input: 52.49 toks/s, output: 13.37 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_792 (iteration 110) for method prolog
Processing sample logical_deduction_636 (iteration 111) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.29s/it, est. speed input: 43.95 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.29s/it, est. speed input: 43.95 toks/s, output: 13.61 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:21:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:28:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:29:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:30:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:31:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:32:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:33:
Warning:    Singleton variables: [X]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_636 (iteration 111) for method prolog
Processing sample logical_deduction_554 (iteration 112) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.08s/it, est. speed input: 47.03 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.08s/it, est. speed input: 47.03 toks/s, output: 13.62 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue7, 1)), context(/(solve, 1), _10912))'.
Completed sample logical_deduction_554 (iteration 112) for method prolog
Processing sample logical_deduction_541 (iteration 113) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_541: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1341, in step
    ) = self.scheduler[virtual_engine].schedule()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/core/scheduler.py", line 1533, in schedule
    self.block_manager.get_common_computed_block_ids(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/core/block_manager.py", line 324, in get_common_computed_block_ids
    self._computed_blocks_tracker.get_num_cached_tokens(seq))
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/core/block/prefix_caching_block.py", line 1076, in get_num_cached_tokens
    self._allocator.find_cached_blocks_prefix(block_hashes))
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/core/block/cpu_gpu_block_allocator.py", line 368, in find_cached_blocks_prefix
    return self._allocators[device].find_cached_blocks_prefix(block_hashes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/core/block/prefix_caching_block.py", line 720, in find_cached_blocks_prefix
    idx = _bisect_left(block_hashes,
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/core/block/prefix_caching_block.py", line 716, in _bisect_left
    return bisect_left(a, x, key=key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/core/block/prefix_caching_block.py", line 722, in <lambda>
    key=lambda x: not _block_is_cached(x))
    
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_541 (iteration 113) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1341, in step
    ) = self.scheduler[virtual_engine].schedule()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/core/scheduler.py", line 1533, in schedule
    self.block_manager.get_common_computed_block_ids(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/core/block_manager.py", line 324, in get_common_computed_block_ids
    self._computed_blocks_tracker.get_num_cached_tokens(seq))
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/core/block/prefix_caching_block.py", line 1076, in get_num_cached_tokens
    self._allocator.find_cached_blocks_prefix(block_hashes))
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/core/block/cpu_gpu_block_allocator.py", line 368, in find_cached_blocks_prefix
    return self._allocators[device].find_cached_blocks_prefix(block_hashes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/core/block/prefix_caching_block.py", line 720, in find_cached_blocks_prefix
    idx = _bisect_left(block_hashes,
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/core/block/prefix_caching_block.py", line 716, in _bisect_left
    return bisect_left(a, x, key=key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/core/block/prefix_caching_block.py", line 722, in <lambda>
    key=lambda x: not _block_is_cached(x))
    
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:20<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_482 (iteration 114) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:34<00:34, 34.77s/it, est. speed input: 67.45 toks/s, output: 18.87 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:04<00:00, 31.87s/it, est. speed input: 72.49 toks/s, output: 22.39 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:04<00:00, 32.31s/it, est. speed input: 72.49 toks/s, output: 22.39 toks/s]
Prolog output: D
Completed sample logical_deduction_482 (iteration 114) for method prolog
Processing sample logical_deduction_953 (iteration 115) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:57<00:00, 57.91s/it, est. speed input: 40.39 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:57<00:00, 57.91s/it, est. speed input: 40.39 toks/s, output: 13.61 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:25:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:27:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:28:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:29:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:30:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:31:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:32:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:33:
Warning:    Singleton variables: [Len]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_953 (iteration 115) for method prolog
Processing sample logical_deduction_727 (iteration 116) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:57<00:00, 57.16s/it, est. speed input: 40.85 toks/s, output: 13.65 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:57<00:00, 57.16s/it, est. speed input: 40.85 toks/s, output: 13.65 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:21:
Warning:    Singleton variables: [X]
Prolog output: C
Completed sample logical_deduction_727 (iteration 116) for method prolog
Processing sample logical_deduction_175 (iteration 117) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.53s/it, est. speed input: 43.26 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.53s/it, est. speed input: 43.26 toks/s, output: 13.57 toks/s]
Prolog output: D
Completed sample logical_deduction_175 (iteration 117) for method prolog
Processing sample logical_deduction_678 (iteration 118) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:59<00:00, 59.58s/it, est. speed input: 39.31 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:59<00:00, 59.58s/it, est. speed input: 39.31 toks/s, output: 13.59 toks/s]
Prolog output: E
Completed sample logical_deduction_678 (iteration 118) for method prolog
Processing sample logical_deduction_173 (iteration 119) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.51s/it, est. speed input: 42.15 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.51s/it, est. speed input: 42.15 toks/s, output: 13.60 toks/s]
Prolog output: D
Completed sample logical_deduction_173 (iteration 119) for method prolog
Processing sample logical_deduction_692 (iteration 120) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.58s/it, est. speed input: 44.34 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.58s/it, est. speed input: 44.34 toks/s, output: 13.57 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_692 (iteration 120) for method prolog
Processing sample logical_deduction_479 (iteration 121) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:49<00:00, 49.35s/it, est. speed input: 47.43 toks/s, output: 13.64 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:49<00:00, 49.35s/it, est. speed input: 47.43 toks/s, output: 13.64 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:32:
Warning:    Singleton variables: [Len]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue7, 1)), context(/(solve, 1), _5480))'.
Completed sample logical_deduction_479 (iteration 121) for method prolog
Processing sample logical_deduction_850 (iteration 122) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_850: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 265, in add_lora_linear
    self.add_shrink(buffer, x, lora_a_stacked, scale, **kwargs)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 127, in add_shrink
    self._apply_shrink_decode(y[slice_idx], x,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 63, in _apply_shrink_decode
    bgmv_shrink(x, w_t_all, y, self.token_lora_indices, scale)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/ops/triton_ops/bgmv_shrink.py", line 106, in _bgmv_shrink
    assert inputs.size(1) == lora_a_weights.size(-1)
           ^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_850 (iteration 122) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 265, in add_lora_linear
    self.add_shrink(buffer, x, lora_a_stacked, scale, **kwargs)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 127, in add_shrink
    self._apply_shrink_decode(y[slice_idx], x,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 63, in _apply_shrink_decode
    bgmv_shrink(x, w_t_all, y, self.token_lora_indices, scale)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/ops/triton_ops/bgmv_shrink.py", line 106, in _bgmv_shrink
    assert inputs.size(1) == lora_a_weights.size(-1)
           ^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_681 (iteration 123) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:45<00:45, 45.54s/it, est. speed input: 51.75 toks/s, output: 17.04 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:02<00:00, 28.71s/it, est. speed input: 75.23 toks/s, output: 24.22 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:02<00:00, 31.24s/it, est. speed input: 75.23 toks/s, output: 24.22 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:20:
Warning:    Singleton variables: [X]
Prolog output: F
Completed sample logical_deduction_681 (iteration 123) for method prolog
Processing sample logical_deduction_644 (iteration 124) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.28s/it, est. speed input: 42.29 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.28s/it, est. speed input: 42.29 toks/s, output: 13.62 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:23:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:28:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:29:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:30:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:31:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:32:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:33:
Warning:    Singleton variables: [X]
Prolog output: B
Completed sample logical_deduction_644 (iteration 124) for method prolog
Processing sample logical_deduction_896 (iteration 125) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.38s/it, est. speed input: 41.48 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.39s/it, est. speed input: 41.48 toks/s, output: 13.60 toks/s]
Prolog output: C
Completed sample logical_deduction_896 (iteration 125) for method prolog
Processing sample logical_deduction_933 (iteration 126) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.24s/it, est. speed input: 41.34 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.24s/it, est. speed input: 41.34 toks/s, output: 13.60 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:28:
Warning:    Singleton variables: [Len]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_933 (iteration 126) for method prolog
Processing sample logical_deduction_683 (iteration 127) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:49<00:00, 49.85s/it, est. speed input: 47.02 toks/s, output: 13.64 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:49<00:00, 49.85s/it, est. speed input: 47.02 toks/s, output: 13.64 toks/s]
Prolog output: B
Completed sample logical_deduction_683 (iteration 127) for method prolog
Processing sample logical_deduction_653 (iteration 128) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:49<00:00, 49.91s/it, est. speed input: 46.77 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:49<00:00, 49.91s/it, est. speed input: 46.77 toks/s, output: 13.57 toks/s]
Prolog output: G
Completed sample logical_deduction_653 (iteration 128) for method prolog
Processing sample logical_deduction_665 (iteration 129) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:00<00:00, 60.44s/it, est. speed input: 38.90 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:00<00:00, 60.44s/it, est. speed input: 38.90 toks/s, output: 13.60 toks/s]
Prolog output: C
Completed sample logical_deduction_665 (iteration 129) for method prolog
Processing sample logical_deduction_860 (iteration 130) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.77s/it, est. speed input: 41.69 toks/s, output: 13.63 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.77s/it, est. speed input: 41.69 toks/s, output: 13.63 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_860 (iteration 130) for method prolog
Processing sample logical_deduction_165 (iteration 131) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.54s/it, est. speed input: 45.62 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.54s/it, est. speed input: 45.62 toks/s, output: 13.62 toks/s]
Prolog output: D
Completed sample logical_deduction_165 (iteration 131) for method prolog
Processing sample logical_deduction_562 (iteration 132) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:57<00:00, 57.47s/it, est. speed input: 40.82 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:57<00:00, 57.47s/it, est. speed input: 40.82 toks/s, output: 13.59 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:18:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:20:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:23:
Warning:    Singleton variables: [X]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_562 (iteration 132) for method prolog
Processing sample logical_deduction_856 (iteration 133) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.44s/it, est. speed input: 41.60 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.44s/it, est. speed input: 41.60 toks/s, output: 13.61 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:28:
Warning:    Singleton variables: [Pos]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:29:
Warning:    Singleton variables: [Pos]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:30:
Warning:    Singleton variables: [Pos]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:31:
Warning:    Singleton variables: [Pos]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:32:
Warning:    Singleton variables: [Pos]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:33:
Warning:    Singleton variables: [Pos]
Prolog output: B
Completed sample logical_deduction_856 (iteration 133) for method prolog
Processing sample logical_deduction_195 (iteration 134) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.42s/it, est. speed input: 42.46 toks/s, output: 13.64 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.42s/it, est. speed input: 42.46 toks/s, output: 13.64 toks/s]
Prolog output: A
Completed sample logical_deduction_195 (iteration 134) for method prolog
Processing sample logical_deduction_836 (iteration 135) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.22s/it, est. speed input: 45.31 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.22s/it, est. speed input: 45.31 toks/s, output: 13.59 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:21:
Warning:    Singleton variables: [X]
Prolog output: E
Completed sample logical_deduction_836 (iteration 135) for method prolog
Processing sample logical_deduction_916 (iteration 136) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.56s/it, est. speed input: 43.00 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.56s/it, est. speed input: 43.00 toks/s, output: 13.58 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_916 (iteration 136) for method prolog
Processing sample logical_deduction_853 (iteration 137) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:52<00:00, 52.83s/it, est. speed input: 44.40 toks/s, output: 13.65 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:52<00:00, 52.83s/it, est. speed input: 44.40 toks/s, output: 13.65 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_853 (iteration 137) for method prolog
Processing sample logical_deduction_724 (iteration 138) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.89s/it, est. speed input: 42.65 toks/s, output: 13.63 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.89s/it, est. speed input: 42.65 toks/s, output: 13.63 toks/s]
Prolog output: B
Completed sample logical_deduction_724 (iteration 138) for method prolog
Processing sample logical_deduction_112 (iteration 139) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.43s/it, est. speed input: 44.08 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.43s/it, est. speed input: 44.08 toks/s, output: 13.61 toks/s]
Prolog output: D
Completed sample logical_deduction_112 (iteration 139) for method prolog
Processing sample logical_deduction_943 (iteration 140) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:42<00:00, 42.70s/it, est. speed input: 53.05 toks/s, output: 13.63 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:42<00:00, 42.70s/it, est. speed input: 53.05 toks/s, output: 13.63 toks/s]
Prolog output: C
Completed sample logical_deduction_943 (iteration 140) for method prolog
Processing sample logical_deduction_148 (iteration 141) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.23s/it, est. speed input: 46.03 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.23s/it, est. speed input: 46.03 toks/s, output: 13.61 toks/s]
Prolog output: B
Completed sample logical_deduction_148 (iteration 141) for method prolog
Processing sample logical_deduction_536 (iteration 142) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:46<00:00, 46.56s/it, est. speed input: 48.69 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:46<00:00, 46.56s/it, est. speed input: 48.69 toks/s, output: 13.60 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:25:
Warning:    Singleton variables: [Len]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_536 (iteration 142) for method prolog
Processing sample logical_deduction_867 (iteration 143) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:44<00:00, 44.97s/it, est. speed input: 50.53 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:44<00:00, 44.97s/it, est. speed input: 50.53 toks/s, output: 13.57 toks/s]
Prolog output: A
Completed sample logical_deduction_867 (iteration 143) for method prolog
Processing sample logical_deduction_524 (iteration 144) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:46<00:00, 46.49s/it, est. speed input: 48.75 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:46<00:00, 46.49s/it, est. speed input: 48.75 toks/s, output: 13.57 toks/s]
Prolog output: A
Completed sample logical_deduction_524 (iteration 144) for method prolog
Processing sample logical_deduction_655 (iteration 145) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.69s/it, est. speed input: 43.30 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.69s/it, est. speed input: 43.30 toks/s, output: 13.60 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:21:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:24:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:26:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:27:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:28:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:29:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:30:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:31:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:32:
Warning:    Singleton variables: [Len]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_655 (iteration 145) for method prolog
Processing sample logical_deduction_110 (iteration 146) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.41s/it, est. speed input: 43.00 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.41s/it, est. speed input: 43.00 toks/s, output: 13.60 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_110 (iteration 146) for method prolog
Processing sample logical_deduction_451 (iteration 147) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:42<00:00, 42.99s/it, est. speed input: 52.68 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:42<00:00, 42.99s/it, est. speed input: 52.68 toks/s, output: 13.61 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:20:
Warning:    Singleton variables: [Last]
Prolog output: C
Completed sample logical_deduction_451 (iteration 147) for method prolog
Processing sample logical_deduction_875 (iteration 148) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:59<00:00, 59.26s/it, est. speed input: 39.77 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:59<00:00, 59.26s/it, est. speed input: 39.77 toks/s, output: 13.57 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_875 (iteration 148) for method prolog
Processing sample logical_deduction_930 (iteration 149) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:52<00:00, 52.51s/it, est. speed input: 44.26 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:52<00:00, 52.51s/it, est. speed input: 44.26 toks/s, output: 13.60 toks/s]
Prolog output: E
Completed sample logical_deduction_930 (iteration 149) for method prolog
Processing sample logical_deduction_580 (iteration 150) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:03<00:00, 63.83s/it, est. speed input: 36.55 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:03<00:00, 63.83s/it, est. speed input: 36.55 toks/s, output: 13.58 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:23:
Warning:    Singleton variables: [X]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_580 (iteration 150) for method prolog
Processing sample logical_deduction_624 (iteration 151) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:43<00:00, 43.62s/it, est. speed input: 52.34 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:43<00:00, 43.62s/it, est. speed input: 52.34 toks/s, output: 13.59 toks/s]
Prolog output: A
Completed sample logical_deduction_624 (iteration 151) for method prolog
Processing sample logical_deduction_835 (iteration 152) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.95s/it, est. speed input: 44.81 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.95s/it, est. speed input: 44.81 toks/s, output: 13.59 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_835 (iteration 152) for method prolog
Processing sample logical_deduction_509 (iteration 153) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.94s/it, est. speed input: 47.79 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.94s/it, est. speed input: 47.79 toks/s, output: 13.57 toks/s]
Prolog output: A
Completed sample logical_deduction_509 (iteration 153) for method prolog
Processing sample logical_deduction_405 (iteration 154) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:49<00:00, 49.56s/it, est. speed input: 46.06 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:49<00:00, 49.56s/it, est. speed input: 46.06 toks/s, output: 13.58 toks/s]
Prolog output: F
Completed sample logical_deduction_405 (iteration 154) for method prolog
Processing sample logical_deduction_551 (iteration 155) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.39s/it, est. speed input: 43.70 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.39s/it, est. speed input: 43.70 toks/s, output: 13.60 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:27:
Warning:    Singleton variables: [Len,Pos]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:30:
Warning:    Singleton variables: [Len,Pos]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:31:
Warning:    Singleton variables: [Len,Pos]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_551 (iteration 155) for method prolog
Processing sample logical_deduction_649 (iteration 156) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.61s/it, est. speed input: 42.55 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.61s/it, est. speed input: 42.55 toks/s, output: 13.59 toks/s]
Prolog output: D
Completed sample logical_deduction_649 (iteration 156) for method prolog
Processing sample logical_deduction_809 (iteration 157) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.06s/it, est. speed input: 46.56 toks/s, output: 13.56 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.06s/it, est. speed input: 46.56 toks/s, output: 13.56 toks/s]
Prolog output: A
Completed sample logical_deduction_809 (iteration 157) for method prolog
Processing sample logical_deduction_906 (iteration 158) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:52<00:00, 52.41s/it, est. speed input: 44.24 toks/s, output: 13.53 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:52<00:00, 52.42s/it, est. speed input: 44.24 toks/s, output: 13.53 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_906 (iteration 158) for method prolog
Processing sample logical_deduction_793 (iteration 159) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.65s/it, est. speed input: 47.80 toks/s, output: 13.55 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.65s/it, est. speed input: 47.80 toks/s, output: 13.55 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue7, 1)), context(/(solve, 1), _14998))'.
Completed sample logical_deduction_793 (iteration 159) for method prolog
Processing sample logical_deduction_599 (iteration 160) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_599: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_599 (iteration 160) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_129 (iteration 161) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:45<00:45, 45.30s/it, est. speed input: 51.99 toks/s, output: 17.11 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:59<00:00, 26.78s/it, est. speed input: 79.07 toks/s, output: 24.85 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:59<00:00, 29.56s/it, est. speed input: 79.07 toks/s, output: 24.85 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_129 (iteration 161) for method prolog
Processing sample logical_deduction_824 (iteration 162) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:00<00:00, 60.08s/it, est. speed input: 38.91 toks/s, output: 13.66 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:00<00:00, 60.08s/it, est. speed input: 38.91 toks/s, output: 13.66 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:24:
Warning:    Singleton variables: [X]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_824 (iteration 162) for method prolog
Processing sample logical_deduction_866 (iteration 163) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.09s/it, est. speed input: 42.62 toks/s, output: 13.63 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.09s/it, est. speed input: 42.62 toks/s, output: 13.63 toks/s]
Prolog output: B
Completed sample logical_deduction_866 (iteration 163) for method prolog
Processing sample logical_deduction_474 (iteration 164) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.66s/it, est. speed input: 43.42 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.66s/it, est. speed input: 43.42 toks/s, output: 13.62 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_474 (iteration 164) for method prolog
Processing sample logical_deduction_886 (iteration 165) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.91s/it, est. speed input: 48.09 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.91s/it, est. speed input: 48.09 toks/s, output: 13.58 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue6, 1)), context(/(solve, 1), _46))'.
Completed sample logical_deduction_886 (iteration 165) for method prolog
Processing sample logical_deduction_650 (iteration 166) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_650: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 92, in forward
    x, _ = self.down_proj(x)
           ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 870, in forward
    output_parallel = self.apply(input_parallel)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 266, in add_lora_linear
    self.add_expand(y,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 173, in add_expand
    self._apply_expand_decode(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 95, in _apply_expand_decode
    bgmv_expand_slice(x, w_t_all, y, self.token_lora_indices, y_offset,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_650 (iteration 166) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 92, in forward
    x, _ = self.down_proj(x)
           ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 870, in forward
    output_parallel = self.apply(input_parallel)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 266, in add_lora_linear
    self.add_expand(y,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 173, in add_expand
    self._apply_expand_decode(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 95, in _apply_expand_decode
    bgmv_expand_slice(x, w_t_all, y, self.token_lora_indices, y_offset,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_447 (iteration 167) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:41<00:41, 41.06s/it, est. speed input: 56.59 toks/s, output: 17.73 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:04<00:00, 30.67s/it, est. speed input: 72.59 toks/s, output: 23.33 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:04<00:00, 32.23s/it, est. speed input: 72.59 toks/s, output: 23.33 toks/s]
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:27:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:28:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:29:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:30:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:31:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:32:29: Syntax error: Operator expected
ERROR: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:33:29: Syntax error: Operator expected
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(choose_option, 2)), context(/(solve, 1), _7484))'.
Completed sample logical_deduction_447 (iteration 167) for method prolog
Processing sample logical_deduction_425 (iteration 168) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_425: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1782, in execute_model
    output: SamplerOutput = self.model.sample(
                            ^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 563, in sample
    next_tokens = self.sampler(logits, sampling_metadata)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/sampler.py", line 287, in forward
    maybe_deferred_sample_results, maybe_sampled_tokens_tensor = _sample(
                                                                 ^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/sampler.py", line 775, in _sample
    return _sample_with_torch(
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/sampler.py", line 744, in _sample_with_torch
    return get_pythonized_sample_results(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/sampler.py", line 614, in get_pythonized_sample_results
    sample_results = _greedy_sample(seq_groups, greedy_samples)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/sampler.py", line 449, in _greedy_sample
    samples_lst = samples.tolist()
                  ^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_425 (iteration 168) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1782, in execute_model
    output: SamplerOutput = self.model.sample(
                            ^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 563, in sample
    next_tokens = self.sampler(logits, sampling_metadata)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/sampler.py", line 287, in forward
    maybe_deferred_sample_results, maybe_sampled_tokens_tensor = _sample(
                                                                 ^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/sampler.py", line 775, in _sample
    return _sample_with_torch(
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/sampler.py", line 744, in _sample_with_torch
    return get_pythonized_sample_results(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/sampler.py", line 614, in get_pythonized_sample_results
    sample_results = _greedy_sample(seq_groups, greedy_samples)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/sampler.py", line 449, in _greedy_sample
    samples_lst = samples.tolist()
                  ^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_550 (iteration 169) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:42<00:42, 42.07s/it, est. speed input: 55.91 toks/s, output: 17.54 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:04<00:00, 30.37s/it, est. speed input: 72.95 toks/s, output: 23.46 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:04<00:00, 32.12s/it, est. speed input: 72.95 toks/s, output: 23.46 toks/s]
Prolog output: A
Completed sample logical_deduction_550 (iteration 169) for method prolog
Processing sample logical_deduction_603 (iteration 170) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:52<00:00, 52.43s/it, est. speed input: 44.44 toks/s, output: 13.64 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:52<00:00, 52.43s/it, est. speed input: 44.44 toks/s, output: 13.64 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(type_error(integer, -(7, 1)), _28)'.
Completed sample logical_deduction_603 (iteration 170) for method prolog
Processing sample logical_deduction_630 (iteration 171) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_630: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 90, in forward
    x, _ = self.gate_up_proj(x)
           ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 266, in add_lora_linear
    self.add_expand(y,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 173, in add_expand
    self._apply_expand_decode(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 95, in _apply_expand_decode
    bgmv_expand_slice(x, w_t_all, y, self.token_lora_indices, y_offset,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/ops/triton_ops/bgmv_expand_slice.py", line 143, in _bgmv_expand_slice
    BLOCK_K = triton.next_power_of_2(K)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/__init__.py", line 63, in next_power_of_2
    def next_power_of_2(n: int):
    
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_630 (iteration 171) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 90, in forward
    x, _ = self.gate_up_proj(x)
           ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 266, in add_lora_linear
    self.add_expand(y,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 173, in add_expand
    self._apply_expand_decode(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 95, in _apply_expand_decode
    bgmv_expand_slice(x, w_t_all, y, self.token_lora_indices, y_offset,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/ops/triton_ops/bgmv_expand_slice.py", line 143, in _bgmv_expand_slice
    BLOCK_K = triton.next_power_of_2(K)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/__init__.py", line 63, in next_power_of_2
    def next_power_of_2(n: int):
    
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:20<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_717 (iteration 172) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:38<00:38, 38.63s/it, est. speed input: 60.26 toks/s, output: 18.07 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:49<00:00, 22.43s/it, est. speed input: 92.46 toks/s, output: 25.69 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:49<00:00, 24.86s/it, est. speed input: 92.46 toks/s, output: 25.69 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_717 (iteration 172) for method prolog
Processing sample logical_deduction_640 (iteration 173) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:57<00:00, 57.17s/it, est. speed input: 40.92 toks/s, output: 13.63 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:57<00:00, 57.17s/it, est. speed input: 40.92 toks/s, output: 13.63 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [X]
Prolog output: G
Completed sample logical_deduction_640 (iteration 173) for method prolog
Processing sample logical_deduction_495 (iteration 174) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:01<00:00, 61.11s/it, est. speed input: 38.16 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:01<00:00, 61.12s/it, est. speed input: 38.16 toks/s, output: 13.58 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_495 (iteration 174) for method prolog
Processing sample logical_deduction_743 (iteration 175) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.42s/it, est. speed input: 44.01 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.42s/it, est. speed input: 44.01 toks/s, output: 13.59 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [X]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_743 (iteration 175) for method prolog
Processing sample logical_deduction_174 (iteration 176) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.85s/it, est. speed input: 43.43 toks/s, output: 13.56 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.85s/it, est. speed input: 43.43 toks/s, output: 13.56 toks/s]
Prolog output: A
Completed sample logical_deduction_174 (iteration 176) for method prolog
Processing sample logical_deduction_927 (iteration 177) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.28s/it, est. speed input: 44.48 toks/s, output: 13.53 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.28s/it, est. speed input: 44.48 toks/s, output: 13.53 toks/s]
Prolog output: C
Completed sample logical_deduction_927 (iteration 177) for method prolog
Processing sample logical_deduction_690 (iteration 178) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:57<00:00, 57.19s/it, est. speed input: 41.11 toks/s, output: 13.53 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:57<00:00, 57.19s/it, est. speed input: 41.11 toks/s, output: 13.53 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_690 (iteration 178) for method prolog
Processing sample logical_deduction_486 (iteration 179) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:00<00:00, 60.41s/it, est. speed input: 38.80 toks/s, output: 13.49 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:00<00:00, 60.41s/it, est. speed input: 38.80 toks/s, output: 13.49 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_486 (iteration 179) for method prolog
Processing sample logical_deduction_573 (iteration 180) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:42<00:00, 42.78s/it, est. speed input: 53.03 toks/s, output: 13.53 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:42<00:00, 42.78s/it, est. speed input: 53.03 toks/s, output: 13.53 toks/s]
Prolog output: G
Completed sample logical_deduction_573 (iteration 180) for method prolog
Processing sample logical_deduction_884 (iteration 181) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:01<00:00, 61.75s/it, est. speed input: 37.88 toks/s, output: 13.51 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:01<00:00, 61.75s/it, est. speed input: 37.88 toks/s, output: 13.51 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_884 (iteration 181) for method prolog
Processing sample logical_deduction_231 (iteration 182) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.12s/it, est. speed input: 42.47 toks/s, output: 13.39 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.12s/it, est. speed input: 42.47 toks/s, output: 13.39 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_231 (iteration 182) for method prolog
Processing sample logical_deduction_618 (iteration 183) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.09s/it, est. speed input: 48.35 toks/s, output: 13.52 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.09s/it, est. speed input: 48.35 toks/s, output: 13.52 toks/s]
Prolog output: C
Completed sample logical_deduction_618 (iteration 183) for method prolog
Processing sample logical_deduction_185 (iteration 184) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:01<00:00, 61.89s/it, est. speed input: 38.08 toks/s, output: 13.51 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:01<00:00, 61.90s/it, est. speed input: 38.08 toks/s, output: 13.51 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_185 (iteration 184) for method prolog
Processing sample logical_deduction_852 (iteration 185) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.98s/it, est. speed input: 43.46 toks/s, output: 13.54 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.98s/it, est. speed input: 43.46 toks/s, output: 13.54 toks/s]
Prolog output: B
Completed sample logical_deduction_852 (iteration 185) for method prolog
Processing sample logical_deduction_876 (iteration 186) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.83s/it, est. speed input: 40.99 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.83s/it, est. speed input: 40.99 toks/s, output: 13.57 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:22:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:24:
Warning:    Singleton variables: [X]
Prolog output: A
Completed sample logical_deduction_876 (iteration 186) for method prolog
Processing sample logical_deduction_729 (iteration 187) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.10s/it, est. speed input: 41.98 toks/s, output: 13.56 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.10s/it, est. speed input: 41.98 toks/s, output: 13.56 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:23:
Warning:    Singleton variables: [Len]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(nth1, 7)), context(/(clue2, 1), _2010))'.
Completed sample logical_deduction_729 (iteration 187) for method prolog
Processing sample logical_deduction_161 (iteration 188) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_161: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 127, in _apply_4bit_weight
    out[:, current_index:current_index + output_size] = matmul_4bit(
                                                        ^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py", line 388, in matmul_4bit
    out = F.gemv_4bit(A, B.t(), out, state=quant_state)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 1710, in gemv_4bit
    absmax = dequantize_blockwise(absmax, state.state2) + state.offset
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 861, in dequantize_blockwise
    return torch.ops.bitsandbytes.dequantize_blockwise.default(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 716, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/library.py", line 566, in func_no_dynamo
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/backends/cuda/ops.py", line 246, in _
    _dequantize_blockwise_impl(A, absmax, code, blocksize, dtype, out=out)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/backends/cuda/ops.py", line 268, in _dequantize_blockwise_impl
    torch._check(A.dtype == torch.uint8, lambda: f"A must be uint8, got {A.dtype}")
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/__init__.py", line 1549, in _check
    def _check(cond, message=None):  # noqa: F811
    
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_161 (iteration 188) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 203, in forward
    qkv, _ = self.qkv_proj(hidden_states)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 127, in _apply_4bit_weight
    out[:, current_index:current_index + output_size] = matmul_4bit(
                                                        ^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py", line 388, in matmul_4bit
    out = F.gemv_4bit(A, B.t(), out, state=quant_state)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 1710, in gemv_4bit
    absmax = dequantize_blockwise(absmax, state.state2) + state.offset
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 861, in dequantize_blockwise
    return torch.ops.bitsandbytes.dequantize_blockwise.default(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 716, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/library.py", line 566, in func_no_dynamo
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/backends/cuda/ops.py", line 246, in _
    _dequantize_blockwise_impl(A, absmax, code, blocksize, dtype, out=out)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/backends/cuda/ops.py", line 268, in _dequantize_blockwise_impl
    torch._check(A.dtype == torch.uint8, lambda: f"A must be uint8, got {A.dtype}")
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/__init__.py", line 1549, in _check
    def _check(cond, message=None):  # noqa: F811
    
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_133 (iteration 189) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:44<00:44, 44.02s/it, est. speed input: 53.30 toks/s, output: 17.22 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:03<00:00, 29.72s/it, est. speed input: 73.73 toks/s, output: 23.76 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:03<00:00, 31.87s/it, est. speed input: 73.73 toks/s, output: 23.76 toks/s]
Prolog output: E
Completed sample logical_deduction_133 (iteration 189) for method prolog
Processing sample logical_deduction_840 (iteration 190) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.45s/it, est. speed input: 43.74 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.45s/it, est. speed input: 43.74 toks/s, output: 13.62 toks/s]
Prolog output: G
Completed sample logical_deduction_840 (iteration 190) for method prolog
Processing sample logical_deduction_615 (iteration 191) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.06s/it, est. speed input: 41.47 toks/s, output: 13.56 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.06s/it, est. speed input: 41.47 toks/s, output: 13.56 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:28:
Warning:    Singleton variables: [Len]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:30:
Warning:    Singleton variables: [Len]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_615 (iteration 191) for method prolog
Processing sample logical_deduction_693 (iteration 192) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.60s/it, est. speed input: 45.60 toks/s, output: 13.55 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.60s/it, est. speed input: 45.60 toks/s, output: 13.55 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:18:
Warning:    Singleton variables: [X]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_693 (iteration 192) for method prolog
Processing sample logical_deduction_711 (iteration 193) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:57<00:00, 57.25s/it, est. speed input: 40.80 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:57<00:00, 57.25s/it, est. speed input: 40.80 toks/s, output: 13.57 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:22:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:24:
Warning:    Singleton variables: [X]
Prolog output: F
Completed sample logical_deduction_711 (iteration 193) for method prolog
Processing sample logical_deduction_400 (iteration 194) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:43<00:00, 43.85s/it, est. speed input: 51.66 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:43<00:00, 43.85s/it, est. speed input: 51.66 toks/s, output: 13.57 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [X]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_400 (iteration 194) for method prolog
Processing sample logical_deduction_101 (iteration 195) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.27s/it, est. speed input: 45.62 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.27s/it, est. speed input: 45.62 toks/s, output: 13.60 toks/s]
Prolog output: A
Completed sample logical_deduction_101 (iteration 195) for method prolog
Processing sample logical_deduction_815 (iteration 196) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.71s/it, est. speed input: 42.06 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.71s/it, est. speed input: 42.06 toks/s, output: 13.59 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(clue7, 1)), context(/(solve, 1), _46))'.
Completed sample logical_deduction_815 (iteration 196) for method prolog
Processing sample logical_deduction_708 (iteration 197) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_708: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 205, in forward
    q, k = self.rotary_emb(positions, q, k)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/custom_op.py", line 25, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/rotary_embedding.py", line 163, in forward_cuda
    self.cos_sin_cache = self.cos_sin_cache.to(query.device,
    ^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2016, in __setattr__
    sign = inspect.signature(self.register_buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cvmfs/hpc.rug.nl/versions/2023.01/rocky8/x86_64/intel/icelake/software/Python/3.11.5-GCCcore-13.2.0/lib/python3.11/inspect.py", line 3280, in signature
    return Signature.from_callable(obj, follow_wrapped=follow_wrapped,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cvmfs/hpc.rug.nl/versions/2023.01/rocky8/x86_64/intel/icelake/software/Python/3.11.5-GCCcore-13.2.0/lib/python3.11/inspect.py", line 3028, in from_callable
    return _signature_from_callable(obj, sigcls=cls,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cvmfs/hpc.rug.nl/versions/2023.01/rocky8/x86_64/intel/icelake/software/Python/3.11.5-GCCcore-13.2.0/lib/python3.11/inspect.py", line 2440, in _signature_from_callable
    _get_signature_of = functools.partial(_signature_from_callable,
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_708 (iteration 197) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 205, in forward
    q, k = self.rotary_emb(positions, q, k)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/custom_op.py", line 25, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/rotary_embedding.py", line 163, in forward_cuda
    self.cos_sin_cache = self.cos_sin_cache.to(query.device,
    ^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2016, in __setattr__
    sign = inspect.signature(self.register_buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cvmfs/hpc.rug.nl/versions/2023.01/rocky8/x86_64/intel/icelake/software/Python/3.11.5-GCCcore-13.2.0/lib/python3.11/inspect.py", line 3280, in signature
    return Signature.from_callable(obj, follow_wrapped=follow_wrapped,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cvmfs/hpc.rug.nl/versions/2023.01/rocky8/x86_64/intel/icelake/software/Python/3.11.5-GCCcore-13.2.0/lib/python3.11/inspect.py", line 3028, in from_callable
    return _signature_from_callable(obj, sigcls=cls,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cvmfs/hpc.rug.nl/versions/2023.01/rocky8/x86_64/intel/icelake/software/Python/3.11.5-GCCcore-13.2.0/lib/python3.11/inspect.py", line 2440, in _signature_from_callable
    _get_signature_of = functools.partial(_signature_from_callable,
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:20<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_122 (iteration 198) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:36<00:36, 36.00s/it, est. speed input: 65.53 toks/s, output: 18.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:00<00:00, 29.14s/it, est. speed input: 78.13 toks/s, output: 23.24 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:00<00:00, 30.17s/it, est. speed input: 78.13 toks/s, output: 23.24 toks/s]
Prolog output: E
Completed sample logical_deduction_122 (iteration 198) for method prolog
Processing sample logical_deduction_170 (iteration 199) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.93s/it, est. speed input: 42.69 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.93s/it, est. speed input: 42.69 toks/s, output: 13.62 toks/s]
Prolog output: A
Completed sample logical_deduction_170 (iteration 199) for method prolog
Processing sample logical_deduction_578 (iteration 200) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.48s/it, est. speed input: 44.87 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.48s/it, est. speed input: 44.87 toks/s, output: 13.59 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:23:
Warning:    Singleton variables: [Len]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_578 (iteration 200) for method prolog
Processing sample logical_deduction_788 (iteration 201) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.15s/it, est. speed input: 46.72 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.15s/it, est. speed input: 46.72 toks/s, output: 13.58 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:20:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:25:
Warning:    Singleton variables: [X]
Prolog output: D
Completed sample logical_deduction_788 (iteration 201) for method prolog
Processing sample logical_deduction_830 (iteration 202) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.24s/it, est. speed input: 46.62 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.24s/it, est. speed input: 46.62 toks/s, output: 13.58 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_830 (iteration 202) for method prolog
Processing sample logical_deduction_596 (iteration 203) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.35s/it, est. speed input: 48.23 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.35s/it, est. speed input: 48.23 toks/s, output: 13.59 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_596 (iteration 203) for method prolog
Processing sample logical_deduction_530 (iteration 204) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.59s/it, est. speed input: 44.99 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.59s/it, est. speed input: 44.99 toks/s, output: 13.58 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:25:
Warning:    Singleton variables: [Last]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(nth1, 5)), context(/(clue6, 1), _46))'.
Completed sample logical_deduction_530 (iteration 204) for method prolog
Processing sample logical_deduction_107 (iteration 205) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_107: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 90, in forward
    x, _ = self.gate_up_proj(x)
           ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 127, in _apply_4bit_weight
    out[:, current_index:current_index + output_size] = matmul_4bit(
                                                        ^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py", line 388, in matmul_4bit
    out = F.gemv_4bit(A, B.t(), out, state=quant_state)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 1710, in gemv_4bit
    absmax = dequantize_blockwise(absmax, state.state2) + state.offset
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 861, in dequantize_blockwise
    return torch.ops.bitsandbytes.dequantize_blockwise.default(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 716, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/library.py", line 566, in func_no_dynamo
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/backends/cuda/ops.py", line 246, in _
    _dequantize_blockwise_impl(A, absmax, code, blocksize, dtype, out=out)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/backends/cuda/ops.py", line 269, in _dequantize_blockwise_impl
    torch._check(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/__init__.py", line 1564, in _check
    _check_with(RuntimeError, cond, message)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/__init__.py", line 1527, in _check_with
    if expect_true(cond):
       ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/fx/experimental/symbolic_shapes.py", line 1004, in expect_true
    def expect_true(a, skip: int = 0):
    
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_107 (iteration 205) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 90, in forward
    x, _ = self.gate_up_proj(x)
           ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 523, in forward
    output_parallel = self.apply(input_, bias)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 127, in _apply_4bit_weight
    out[:, current_index:current_index + output_size] = matmul_4bit(
                                                        ^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py", line 388, in matmul_4bit
    out = F.gemv_4bit(A, B.t(), out, state=quant_state)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 1710, in gemv_4bit
    absmax = dequantize_blockwise(absmax, state.state2) + state.offset
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/functional.py", line 861, in dequantize_blockwise
    return torch.ops.bitsandbytes.dequantize_blockwise.default(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 716, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/library.py", line 566, in func_no_dynamo
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/backends/cuda/ops.py", line 246, in _
    _dequantize_blockwise_impl(A, absmax, code, blocksize, dtype, out=out)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/bitsandbytes/backends/cuda/ops.py", line 269, in _dequantize_blockwise_impl
    torch._check(
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/__init__.py", line 1564, in _check
    _check_with(RuntimeError, cond, message)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/__init__.py", line 1527, in _check_with
    if expect_true(cond):
       ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/fx/experimental/symbolic_shapes.py", line 1004, in expect_true
    def expect_true(a, skip: int = 0):
    
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:20<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_702 (iteration 206) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:43<00:43, 44.00s/it, est. speed input: 53.32 toks/s, output: 17.23 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:56<00:00, 25.72s/it, est. speed input: 82.25 toks/s, output: 24.98 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:56<00:00, 28.46s/it, est. speed input: 82.25 toks/s, output: 24.98 toks/s]
Prolog output: F
Completed sample logical_deduction_702 (iteration 206) for method prolog
Processing sample logical_deduction_812 (iteration 207) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.62s/it, est. speed input: 43.49 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.62s/it, est. speed input: 43.49 toks/s, output: 13.58 toks/s]
Prolog output: F
Completed sample logical_deduction_812 (iteration 207) for method prolog
Processing sample logical_deduction_734 (iteration 208) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.95s/it, est. speed input: 46.56 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.95s/it, est. speed input: 46.56 toks/s, output: 13.61 toks/s]
Prolog output: G
Completed sample logical_deduction_734 (iteration 208) for method prolog
Processing sample logical_deduction_818 (iteration 209) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:49<00:00, 49.72s/it, est. speed input: 46.74 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:49<00:00, 49.72s/it, est. speed input: 46.74 toks/s, output: 13.62 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_818 (iteration 209) for method prolog
Processing sample logical_deduction_716 (iteration 210) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.15s/it, est. speed input: 45.54 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.15s/it, est. speed input: 45.54 toks/s, output: 13.60 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_716 (iteration 210) for method prolog
Processing sample logical_deduction_919 (iteration 211) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.45s/it, est. speed input: 42.35 toks/s, output: 13.56 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.45s/it, est. speed input: 42.35 toks/s, output: 13.56 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:23:
Warning:    Singleton variables: [Len]
Prolog output: C
Completed sample logical_deduction_919 (iteration 211) for method prolog
Processing sample logical_deduction_707 (iteration 212) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.05s/it, est. speed input: 42.69 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.05s/it, est. speed input: 42.69 toks/s, output: 13.57 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:22:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:28:
Warning:    Singleton variables: [X]
Prolog output: D
Completed sample logical_deduction_707 (iteration 212) for method prolog
Processing sample logical_deduction_527 (iteration 213) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.14s/it, est. speed input: 48.71 toks/s, output: 13.63 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:48<00:00, 48.14s/it, est. speed input: 48.71 toks/s, output: 13.63 toks/s]
Prolog output: F
Completed sample logical_deduction_527 (iteration 213) for method prolog
Processing sample logical_deduction_234 (iteration 214) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.02s/it, est. speed input: 42.64 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.02s/it, est. speed input: 42.64 toks/s, output: 13.60 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_234 (iteration 214) for method prolog
Processing sample logical_deduction_178 (iteration 215) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:43<00:00, 43.24s/it, est. speed input: 52.47 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:43<00:00, 43.24s/it, est. speed input: 52.47 toks/s, output: 13.60 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_178 (iteration 215) for method prolog
Processing sample logical_deduction_738 (iteration 216) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:44<00:00, 44.09s/it, est. speed input: 51.40 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:44<00:00, 44.09s/it, est. speed input: 51.40 toks/s, output: 13.59 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_738 (iteration 216) for method prolog
Processing sample logical_deduction_471 (iteration 217) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.33s/it, est. speed input: 42.49 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.33s/it, est. speed input: 42.49 toks/s, output: 13.61 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_471 (iteration 217) for method prolog
Processing sample logical_deduction_841 (iteration 218) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.15s/it, est. speed input: 41.71 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.15s/it, est. speed input: 41.71 toks/s, output: 13.62 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:22:
Warning:    Singleton variables: [Len]
Prolog output: A
Completed sample logical_deduction_841 (iteration 218) for method prolog
Processing sample logical_deduction_772 (iteration 219) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:44<00:00, 44.37s/it, est. speed input: 51.46 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:44<00:00, 44.37s/it, est. speed input: 51.46 toks/s, output: 13.57 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_772 (iteration 219) for method prolog
Processing sample logical_deduction_601 (iteration 220) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.68s/it, est. speed input: 41.09 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.68s/it, est. speed input: 41.09 toks/s, output: 13.62 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:22:
Warning:    Singleton variables: [X]
Prolog output: A
Completed sample logical_deduction_601 (iteration 220) for method prolog
Processing sample logical_deduction_951 (iteration 221) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.04s/it, est. speed input: 42.61 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.04s/it, est. speed input: 42.61 toks/s, output: 13.57 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_951 (iteration 221) for method prolog
Processing sample logical_deduction_932 (iteration 222) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.79s/it, est. speed input: 46.23 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.79s/it, est. speed input: 46.23 toks/s, output: 13.60 toks/s]
Prolog output: A
Completed sample logical_deduction_932 (iteration 222) for method prolog
Processing sample logical_deduction_401 (iteration 223) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:00<00:00, 60.37s/it, est. speed input: 38.94 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:00<00:00, 60.37s/it, est. speed input: 38.94 toks/s, output: 13.62 toks/s]
Prolog output: D
Completed sample logical_deduction_401 (iteration 223) for method prolog
Processing sample logical_deduction_233 (iteration 224) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.25s/it, est. speed input: 46.79 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.25s/it, est. speed input: 46.79 toks/s, output: 13.61 toks/s]
Prolog output: B
Completed sample logical_deduction_233 (iteration 224) for method prolog
Processing sample logical_deduction_445 (iteration 225) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.11s/it, est. speed input: 46.72 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:50<00:00, 50.11s/it, est. speed input: 46.72 toks/s, output: 13.61 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_445 (iteration 225) for method prolog
Processing sample logical_deduction_660 (iteration 226) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.63s/it, est. speed input: 43.99 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:53<00:00, 53.63s/it, est. speed input: 43.99 toks/s, output: 13.61 toks/s]
Prolog output: F
Completed sample logical_deduction_660 (iteration 226) for method prolog
Processing sample logical_deduction_594 (iteration 227) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.18s/it, est. speed input: 41.92 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:56<00:00, 56.18s/it, est. speed input: 41.92 toks/s, output: 13.62 toks/s]
Prolog output: G
Completed sample logical_deduction_594 (iteration 227) for method prolog
Processing sample logical_deduction_130 (iteration 228) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:36<00:00, 96.44s/it, est. speed input: 24.22 toks/s, output: 13.69 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:36<00:00, 96.44s/it, est. speed input: 24.22 toks/s, output: 13.69 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_130 (iteration 228) for method prolog
Processing sample logical_deduction_794 (iteration 229) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.79s/it, est. speed input: 44.81 toks/s, output: 13.67 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.79s/it, est. speed input: 44.81 toks/s, output: 13.67 toks/s]
Prolog output: G
Completed sample logical_deduction_794 (iteration 229) for method prolog
Processing sample logical_deduction_518 (iteration 230) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:52<00:00, 52.90s/it, est. speed input: 44.36 toks/s, output: 13.65 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:52<00:00, 52.90s/it, est. speed input: 44.36 toks/s, output: 13.65 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [X,Y]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(nth1, 7)), context(/(clue1, 1), _46))'.
Completed sample logical_deduction_518 (iteration 230) for method prolog
Processing sample logical_deduction_923 (iteration 231) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_923: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 207, in forward
    output, _ = self.o_proj(attn_output)
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 870, in forward
    output_parallel = self.apply(input_parallel)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 130, in _apply_4bit_weight
    current_index += output_size
    ^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_923 (iteration 231) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 282, in forward
    hidden_states = self.self_attn(positions=positions,
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 207, in forward
    output, _ = self.o_proj(attn_output)
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 870, in forward
    output_parallel = self.apply(input_parallel)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 397, in apply
    output = self.base_layer.quant_method.apply(self.base_layer, x, bias)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/layers/quantization/bitsandbytes.py", line 237, in apply
    return self._apply_4bit_weight(layer, x, bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/unsloth_zoo/vllm_utils.py", line 130, in _apply_4bit_weight
    current_index += output_size
    ^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_160 (iteration 232) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:41<00:41, 41.25s/it, est. speed input: 56.19 toks/s, output: 17.70 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:02<00:00, 29.25s/it, est. speed input: 74.87 toks/s, output: 23.70 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [01:02<00:00, 31.05s/it, est. speed input: 74.87 toks/s, output: 23.70 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [X]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:30:
Warning:    Singleton variables: [Len]
Prolog output: D
Completed sample logical_deduction_160 (iteration 232) for method prolog
Processing sample logical_deduction_846 (iteration 233) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.13s/it, est. speed input: 45.74 toks/s, output: 13.63 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:51<00:00, 51.13s/it, est. speed input: 45.74 toks/s, output: 13.63 toks/s]
Prolog output: A
Completed sample logical_deduction_846 (iteration 233) for method prolog
Processing sample logical_deduction_721 (iteration 234) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.40s/it, est. speed input: 42.44 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:55<00:00, 55.40s/it, est. speed input: 42.44 toks/s, output: 13.61 toks/s]
Prolog output: D
Completed sample logical_deduction_721 (iteration 234) for method prolog
Processing sample logical_deduction_753 (iteration 235) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:41<00:00, 41.13s/it, est. speed input: 55.02 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:41<00:00, 41.13s/it, est. speed input: 55.02 toks/s, output: 13.61 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:21:
Warning:    Singleton variables: [Len]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_753 (iteration 235) for method prolog
Processing sample logical_deduction_844 (iteration 236) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.72s/it, est. speed input: 42.76 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:54<00:00, 54.72s/it, est. speed input: 42.76 toks/s, output: 13.61 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_844 (iteration 236) for method prolog
Processing sample logical_deduction_150 (iteration 237) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:43<00:00, 43.90s/it, est. speed input: 51.70 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:43<00:00, 43.90s/it, est. speed input: 51.70 toks/s, output: 13.62 toks/s]
Prolog output: Error (invalid answer)
Completed sample logical_deduction_150 (iteration 237) for method prolog
Processing sample logical_deduction_511 (iteration 238) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:58<00:00, 58.09s/it, est. speed input: 40.41 toks/s, output: 13.65 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:58<00:00, 58.09s/it, est. speed input: 40.41 toks/s, output: 13.65 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:19:
Warning:    Singleton variables: [X,Y]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(existence_error(procedure, /(nth1, 7)), context(/(clue1, 1), _46))'.
Completed sample logical_deduction_511 (iteration 238) for method prolog
Processing sample logical_deduction_439 (iteration 239) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_439: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 92, in forward
    x, _ = self.down_proj(x)
           ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 870, in forward
    output_parallel = self.apply(input_parallel)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 265, in add_lora_linear
    self.add_shrink(buffer, x, lora_a_stacked, scale, **kwargs)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 127, in add_shrink
    self._apply_shrink_decode(y[slice_idx], x,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 63, in _apply_shrink_decode
    bgmv_shrink(x, w_t_all, y, self.token_lora_indices, scale)
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_439 (iteration 239) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 368, in forward
    hidden_states, residual = layer(positions, hidden_states,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 290, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 92, in forward
    x, _ = self.down_proj(x)
           ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 870, in forward
    output_parallel = self.apply(input_parallel)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 398, in apply
    self.punica_wrapper.add_lora_linear(output, x, self.lora_a_stacked,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 265, in add_lora_linear
    self.add_shrink(buffer, x, lora_a_stacked, scale, **kwargs)
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 127, in add_shrink
    self._apply_shrink_decode(y[slice_idx], x,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 63, in _apply_shrink_decode
    bgmv_shrink(x, w_t_all, y, self.token_lora_indices, scale)
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:19<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_1125 (iteration 240) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:23<00:23, 23.71s/it, est. speed input: 93.96 toks/s, output: 11.13 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:30<00:00, 13.65s/it, est. speed input: 148.92 toks/s, output: 29.30 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:30<00:00, 15.16s/it, est. speed input: 148.92 toks/s, output: 29.30 toks/s]
Prolog output: G
Completed sample logical_deduction_1125 (iteration 240) for method prolog
Processing sample logical_deduction_244 (iteration 241) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.60s/it, est. speed input: 113.95 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.60s/it, est. speed input: 113.95 toks/s, output: 13.57 toks/s]
Prolog output: B
Completed sample logical_deduction_244 (iteration 241) for method prolog
Processing sample logical_deduction_1191 (iteration 242) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.98s/it, est. speed input: 112.14 toks/s, output: 13.51 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.98s/it, est. speed input: 112.14 toks/s, output: 13.51 toks/s]
Prolog output: C
Completed sample logical_deduction_1191 (iteration 242) for method prolog
Processing sample logical_deduction_984 (iteration 243) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.21s/it, est. speed input: 115.30 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.21s/it, est. speed input: 115.30 toks/s, output: 13.59 toks/s]
Prolog output: B
Completed sample logical_deduction_984 (iteration 243) for method prolog
Processing sample logical_deduction_1120 (iteration 244) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.27s/it, est. speed input: 105.25 toks/s, output: 13.49 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.27s/it, est. speed input: 105.25 toks/s, output: 13.49 toks/s]
Prolog output: A
Completed sample logical_deduction_1120 (iteration 244) for method prolog
Processing sample logical_deduction_995 (iteration 245) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.64s/it, est. speed input: 108.33 toks/s, output: 13.52 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.64s/it, est. speed input: 108.33 toks/s, output: 13.52 toks/s]
Prolog output: A
Completed sample logical_deduction_995 (iteration 245) for method prolog
Processing sample logical_deduction_1174 (iteration 246) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.10s/it, est. speed input: 115.99 toks/s, output: 13.56 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.10s/it, est. speed input: 115.99 toks/s, output: 13.56 toks/s]
Prolog output: C
Completed sample logical_deduction_1174 (iteration 246) for method prolog
Processing sample logical_deduction_1134 (iteration 247) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.13s/it, est. speed input: 115.78 toks/s, output: 13.54 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.13s/it, est. speed input: 115.78 toks/s, output: 13.54 toks/s]
Prolog output: B
Completed sample logical_deduction_1134 (iteration 247) for method prolog
Processing sample logical_deduction_1128 (iteration 248) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.40s/it, est. speed input: 104.44 toks/s, output: 13.55 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.40s/it, est. speed input: 104.44 toks/s, output: 13.55 toks/s]
Prolog output: A
Completed sample logical_deduction_1128 (iteration 248) for method prolog
Processing sample logical_deduction_273 (iteration 249) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:18<00:00, 18.37s/it, est. speed input: 120.55 toks/s, output: 13.50 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:18<00:00, 18.37s/it, est. speed input: 120.55 toks/s, output: 13.50 toks/s]
Prolog output: A
Completed sample logical_deduction_273 (iteration 249) for method prolog
Processing sample logical_deduction_1144 (iteration 250) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.06s/it, est. speed input: 116.19 toks/s, output: 13.53 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.06s/it, est. speed input: 116.19 toks/s, output: 13.53 toks/s]
Prolog output: A
Completed sample logical_deduction_1144 (iteration 250) for method prolog
Processing sample logical_deduction_1153 (iteration 251) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.17s/it, est. speed input: 115.54 toks/s, output: 13.51 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.17s/it, est. speed input: 115.54 toks/s, output: 13.51 toks/s]
Prolog output: B
Completed sample logical_deduction_1153 (iteration 251) for method prolog
Processing sample logical_deduction_1133 (iteration 252) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.01s/it, est. speed input: 112.10 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.01s/it, est. speed input: 112.10 toks/s, output: 13.59 toks/s]
Prolog output: A
Completed sample logical_deduction_1133 (iteration 252) for method prolog
Processing sample logical_deduction_1024 (iteration 253) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.75s/it, est. speed input: 112.96 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.75s/it, est. speed input: 112.96 toks/s, output: 13.57 toks/s]
Prolog output: B
Completed sample logical_deduction_1024 (iteration 253) for method prolog
Processing sample logical_deduction_1118 (iteration 254) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.16s/it, est. speed input: 115.59 toks/s, output: 13.52 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.16s/it, est. speed input: 115.59 toks/s, output: 13.52 toks/s]
Prolog output: C
Completed sample logical_deduction_1118 (iteration 254) for method prolog
Processing sample logical_deduction_1057 (iteration 255) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.75s/it, est. speed input: 103.16 toks/s, output: 13.56 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.75s/it, est. speed input: 103.16 toks/s, output: 13.56 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:10:
Warning:    Singleton variables: [X]
Prolog output: A
Completed sample logical_deduction_1057 (iteration 255) for method prolog
Processing sample logical_deduction_1072 (iteration 256) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.33s/it, est. speed input: 105.14 toks/s, output: 13.55 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.33s/it, est. speed input: 105.14 toks/s, output: 13.55 toks/s]
Prolog output: B
Completed sample logical_deduction_1072 (iteration 256) for method prolog
Processing sample logical_deduction_1140 (iteration 257) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.20s/it, est. speed input: 110.41 toks/s, output: 13.52 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.20s/it, est. speed input: 110.41 toks/s, output: 13.52 toks/s]
Prolog output: C
Completed sample logical_deduction_1140 (iteration 257) for method prolog
Processing sample logical_deduction_1077 (iteration 258) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:22<00:00, 22.27s/it, est. speed input: 100.96 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:22<00:00, 22.27s/it, est. speed input: 100.96 toks/s, output: 13.61 toks/s]
Prolog output: A
Completed sample logical_deduction_1077 (iteration 258) for method prolog
Processing sample logical_deduction_1106 (iteration 259) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.90s/it, est. speed input: 102.31 toks/s, output: 13.56 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.90s/it, est. speed input: 102.31 toks/s, output: 13.56 toks/s]
Prolog output: C
Completed sample logical_deduction_1106 (iteration 259) for method prolog
Processing sample logical_deduction_294 (iteration 260) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.11s/it, est. speed input: 116.97 toks/s, output: 13.55 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.11s/it, est. speed input: 116.97 toks/s, output: 13.55 toks/s]
Prolog output: A
Completed sample logical_deduction_294 (iteration 260) for method prolog
Processing sample logical_deduction_985 (iteration 261) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.57s/it, est. speed input: 113.34 toks/s, output: 13.54 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.57s/it, est. speed input: 113.34 toks/s, output: 13.54 toks/s]
Prolog output: C
Completed sample logical_deduction_985 (iteration 261) for method prolog
Processing sample logical_deduction_287 (iteration 262) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.81s/it, est. speed input: 113.13 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.81s/it, est. speed input: 113.13 toks/s, output: 13.58 toks/s]
Prolog output: A
Completed sample logical_deduction_287 (iteration 262) for method prolog
Processing sample logical_deduction_1100 (iteration 263) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.64s/it, est. speed input: 103.43 toks/s, output: 13.54 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.64s/it, est. speed input: 103.43 toks/s, output: 13.54 toks/s]
Prolog output: B
Completed sample logical_deduction_1100 (iteration 263) for method prolog
Processing sample logical_deduction_1162 (iteration 264) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:22<00:00, 22.31s/it, est. speed input: 100.77 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:22<00:00, 22.31s/it, est. speed input: 100.77 toks/s, output: 13.58 toks/s]
Prolog output: C
Completed sample logical_deduction_1162 (iteration 264) for method prolog
Processing sample logical_deduction_971 (iteration 265) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.67s/it, est. speed input: 108.10 toks/s, output: 13.55 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.67s/it, est. speed input: 108.10 toks/s, output: 13.55 toks/s]
Prolog output: Error: Caused by: 'solve(Answer)'. Returned: 'error(type_error(integer, [Atom('687877'), Atom('520325'), Atom('519941')]), _9622)'.
Completed sample logical_deduction_971 (iteration 265) for method prolog
Processing sample logical_deduction_267 (iteration 266) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]generate_prolog failed for sample logical_deduction_267: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 359, in forward
    hidden_states = self.get_input_embeddings(input_ids)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 344, in get_input_embeddings
    return self.embed_tokens(input_ids)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 261, in forward
    self.punica_wrapper.add_lora_embedding(full_output,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 213, in add_lora_embedding
    bgmv_expand(x, lora_b_stacked, y, self.token_lora_indices,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/ops/triton_ops/bgmv_expand.py", line 145, in _bgmv_expand
    _bgmv_expand_kernel[grid](
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/runtime/jit.py", line 345, in <lambda>
    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/runtime/jit.py", line 691, in run
    kernel.run(grid_0, grid_1, grid_2, stream, kernel.function, kernel.packed_metadata, launch_metadata,
                                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/compiler/compiler.py", line 382, in __getattribute__
    return super().__getattribute__(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Error processing sample logical_deduction_267 (iteration 266) for method prolog: 
Traceback (most recent call last):
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 450, in get_method_results
    output, code, result = generate_prolog(sample, model, tokenizer, sampling_params, grpo, lora_path)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 586, in generate_prolog
    output = generate(model, tokenizer, sample["prompt"], sampling_params, use_lora, lora_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 580, in generate
    return model.fast_generate(text, sampling_params=sampling_params,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 1057, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 469, in generate
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1397, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/engine/llm_engine.py", line 1391, in step
    outputs = self.model_executor.execute_model(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 139, in execute_model
    output = self.collective_rpc("execute_model",
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 56, in collective_rpc
    answer = run_method(self.driver_worker, method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/utils.py", line 2196, in run_method
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/worker_base.py", line 420, in execute_model
    output = self.model_runner.execute_model(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/worker/model_runner.py", line 1724, in execute_model
    hidden_or_intermediate_states = model_executable(
                                    ^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 547, in forward
    model_output = self.model(input_ids, positions, kv_caches,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 172, in __call__
    return self.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 359, in forward
    hidden_states = self.get_input_embeddings(input_ids)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/model_executor/models/llama.py", line 344, in get_input_embeddings
    return self.embed_tokens(input_ids)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/layers.py", line 261, in forward
    self.punica_wrapper.add_lora_embedding(full_output,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/punica_wrapper/punica_gpu.py", line 213, in add_lora_embedding
    bgmv_expand(x, lora_b_stacked, y, self.token_lora_indices,
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/_ops.py", line 1116, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/vllm/lora/ops/triton_ops/bgmv_expand.py", line 145, in _bgmv_expand
    _bgmv_expand_kernel[grid](
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/runtime/jit.py", line 345, in <lambda>
    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/runtime/jit.py", line 691, in run
    kernel.run(grid_0, grid_1, grid_2, stream, kernel.function, kernel.packed_metadata, launch_metadata,
                                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/projectEnvironment/lib/python3.11/site-packages/triton/compiler/compiler.py", line 382, in __getattribute__
    return super().__getattribute__(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/s5112583/thesis/RL/utils_exp.py", line 824, in timeout_handler
    raise TimeoutException()
utils_exp.TimeoutException
Processed prompts:   0%|          | 0/1 [00:20<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processing sample logical_deduction_1111 (iteration 267) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/2 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:02<00:02,  2.17s/it, est. speed input: 1027.99 toks/s, output: 135.29 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:21<00:00, 12.01s/it, est. speed input: 212.14 toks/s, output: 27.30 toks/s]  Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:21<00:00, 10.53s/it, est. speed input: 212.14 toks/s, output: 27.30 toks/s]
Prolog output: A
Completed sample logical_deduction_1111 (iteration 267) for method prolog
Processing sample logical_deduction_1143 (iteration 268) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.23s/it, est. speed input: 110.60 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.23s/it, est. speed input: 110.60 toks/s, output: 13.60 toks/s]
Prolog output: C
Completed sample logical_deduction_1143 (iteration 268) for method prolog
Processing sample logical_deduction_296 (iteration 269) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.26s/it, est. speed input: 115.01 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.26s/it, est. speed input: 115.01 toks/s, output: 13.60 toks/s]
Prolog output: C
Completed sample logical_deduction_296 (iteration 269) for method prolog
Processing sample logical_deduction_1081 (iteration 270) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.39s/it, est. speed input: 105.23 toks/s, output: 13.56 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.39s/it, est. speed input: 105.23 toks/s, output: 13.56 toks/s]
Prolog output: C
Completed sample logical_deduction_1081 (iteration 270) for method prolog
Processing sample logical_deduction_1014 (iteration 271) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:22<00:00, 22.11s/it, est. speed input: 101.53 toks/s, output: 13.52 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:22<00:00, 22.11s/it, est. speed input: 101.53 toks/s, output: 13.52 toks/s]
Prolog output: B
Completed sample logical_deduction_1014 (iteration 271) for method prolog
Processing sample logical_deduction_247 (iteration 272) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.12s/it, est. speed input: 111.04 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.12s/it, est. speed input: 111.04 toks/s, output: 13.62 toks/s]
Prolog output: A
Completed sample logical_deduction_247 (iteration 272) for method prolog
Processing sample logical_deduction_1156 (iteration 273) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.93s/it, est. speed input: 106.99 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.93s/it, est. speed input: 106.99 toks/s, output: 13.62 toks/s]
Prolog output: C
Completed sample logical_deduction_1156 (iteration 273) for method prolog
Processing sample logical_deduction_1061 (iteration 274) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.77s/it, est. speed input: 107.92 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.77s/it, est. speed input: 107.92 toks/s, output: 13.58 toks/s]
Prolog output: A
Completed sample logical_deduction_1061 (iteration 274) for method prolog
Processing sample logical_deduction_1114 (iteration 275) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:22<00:00, 22.16s/it, est. speed input: 101.03 toks/s, output: 13.54 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:22<00:00, 22.16s/it, est. speed input: 101.03 toks/s, output: 13.54 toks/s]
Prolog output: B
Completed sample logical_deduction_1114 (iteration 275) for method prolog
Processing sample logical_deduction_1193 (iteration 276) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.97s/it, est. speed input: 107.07 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.97s/it, est. speed input: 107.07 toks/s, output: 13.59 toks/s]
Prolog output: C
Completed sample logical_deduction_1193 (iteration 276) for method prolog
Processing sample logical_deduction_1088 (iteration 277) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.83s/it, est. speed input: 107.61 toks/s, output: 13.63 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.83s/it, est. speed input: 107.61 toks/s, output: 13.63 toks/s]
Prolog output: A
Completed sample logical_deduction_1088 (iteration 277) for method prolog
Processing sample logical_deduction_1177 (iteration 278) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.27s/it, est. speed input: 110.69 toks/s, output: 13.61 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.27s/it, est. speed input: 110.69 toks/s, output: 13.61 toks/s]
Prolog output: C
Completed sample logical_deduction_1177 (iteration 278) for method prolog
Processing sample logical_deduction_1113 (iteration 279) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.59s/it, est. speed input: 103.79 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.59s/it, est. speed input: 103.79 toks/s, output: 13.57 toks/s]
Prolog output: C
Completed sample logical_deduction_1113 (iteration 279) for method prolog
Processing sample logical_deduction_1136 (iteration 280) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.63s/it, est. speed input: 108.72 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.63s/it, est. speed input: 108.72 toks/s, output: 13.62 toks/s]
Prolog output: A
Completed sample logical_deduction_1136 (iteration 280) for method prolog
Processing sample logical_deduction_1186 (iteration 281) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:18<00:00, 18.35s/it, est. speed input: 120.63 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:18<00:00, 18.35s/it, est. speed input: 120.63 toks/s, output: 13.57 toks/s]
Prolog output: A
Completed sample logical_deduction_1186 (iteration 281) for method prolog
Processing sample logical_deduction_997 (iteration 282) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:22<00:00, 22.13s/it, est. speed input: 101.65 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:22<00:00, 22.13s/it, est. speed input: 101.65 toks/s, output: 13.60 toks/s]
Prolog output: C
Completed sample logical_deduction_997 (iteration 282) for method prolog
Processing sample logical_deduction_1040 (iteration 283) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.41s/it, est. speed input: 109.61 toks/s, output: 13.62 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.41s/it, est. speed input: 109.61 toks/s, output: 13.62 toks/s]
Prolog output: C
Completed sample logical_deduction_1040 (iteration 283) for method prolog
Processing sample logical_deduction_279 (iteration 284) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:22<00:00, 22.45s/it, est. speed input: 100.29 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:22<00:00, 22.45s/it, est. speed input: 100.29 toks/s, output: 13.59 toks/s]
Prolog output: A
Completed sample logical_deduction_279 (iteration 284) for method prolog
Processing sample logical_deduction_1107 (iteration 285) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.88s/it, est. speed input: 107.52 toks/s, output: 13.60 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.88s/it, est. speed input: 107.52 toks/s, output: 13.60 toks/s]
Prolog output: A
Completed sample logical_deduction_1107 (iteration 285) for method prolog
Processing sample logical_deduction_1198 (iteration 286) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.92s/it, est. speed input: 112.18 toks/s, output: 13.40 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.92s/it, est. speed input: 112.18 toks/s, output: 13.40 toks/s]
Prolog output: B
Completed sample logical_deduction_1198 (iteration 286) for method prolog
Processing sample logical_deduction_964 (iteration 287) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.83s/it, est. speed input: 113.03 toks/s, output: 13.57 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.83s/it, est. speed input: 113.03 toks/s, output: 13.57 toks/s]
Prolog output: B
Completed sample logical_deduction_964 (iteration 287) for method prolog
Processing sample logical_deduction_290 (iteration 288) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.57s/it, est. speed input: 114.08 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.57s/it, est. speed input: 114.08 toks/s, output: 13.59 toks/s]
Prolog output: C
Completed sample logical_deduction_290 (iteration 288) for method prolog
Processing sample logical_deduction_1195 (iteration 289) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.53s/it, est. speed input: 109.08 toks/s, output: 13.59 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.53s/it, est. speed input: 109.08 toks/s, output: 13.59 toks/s]
Prolog output: A
Completed sample logical_deduction_1195 (iteration 289) for method prolog
Processing sample logical_deduction_1090 (iteration 290) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.27s/it, est. speed input: 105.41 toks/s, output: 13.54 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:21<00:00, 21.27s/it, est. speed input: 105.41 toks/s, output: 13.54 toks/s]
Prolog output: A
Completed sample logical_deduction_1090 (iteration 290) for method prolog
Processing sample logical_deduction_1196 (iteration 291) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.77s/it, est. speed input: 107.88 toks/s, output: 13.58 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.77s/it, est. speed input: 107.88 toks/s, output: 13.58 toks/s]
Prolog output: B
Completed sample logical_deduction_1196 (iteration 291) for method prolog
Processing sample logical_deduction_1078 (iteration 292) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.48s/it, est. speed input: 109.07 toks/s, output: 13.52 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.48s/it, est. speed input: 109.07 toks/s, output: 13.52 toks/s]
Prolog output: C
Completed sample logical_deduction_1078 (iteration 292) for method prolog
Processing sample logical_deduction_1033 (iteration 293) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:23<00:00, 23.06s/it, est. speed input: 97.58 toks/s, output: 13.53 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:23<00:00, 23.06s/it, est. speed input: 97.58 toks/s, output: 13.53 toks/s]
Prolog output: A
Completed sample logical_deduction_1033 (iteration 293) for method prolog
Processing sample logical_deduction_254 (iteration 294) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:17<00:00, 17.47s/it, est. speed input: 126.66 toks/s, output: 13.51 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:17<00:00, 17.47s/it, est. speed input: 126.66 toks/s, output: 13.51 toks/s]
Prolog output: C
Completed sample logical_deduction_254 (iteration 294) for method prolog
Processing sample logical_deduction_1083 (iteration 295) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.76s/it, est. speed input: 113.04 toks/s, output: 13.56 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.76s/it, est. speed input: 113.04 toks/s, output: 13.56 toks/s]
Prolog output: B
Completed sample logical_deduction_1083 (iteration 295) for method prolog
Processing sample logical_deduction_1155 (iteration 296) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.93s/it, est. speed input: 112.09 toks/s, output: 13.55 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.93s/it, est. speed input: 112.09 toks/s, output: 13.55 toks/s]
Warning: /scratch/s5112583/thesis/RL/prolog_code/overwritten_code.pl:10:
Warning:    Singleton variables: [X]
Prolog output: B
Completed sample logical_deduction_1155 (iteration 296) for method prolog
Processing sample logical_deduction_1000 (iteration 297) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:22<00:00, 22.25s/it, est. speed input: 100.71 toks/s, output: 13.53 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:22<00:00, 22.25s/it, est. speed input: 100.71 toks/s, output: 13.53 toks/s]
Prolog output: B
Completed sample logical_deduction_1000 (iteration 297) for method prolog
Processing sample logical_deduction_1049 (iteration 298) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.71s/it, est. speed input: 113.24 toks/s, output: 13.55 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:19<00:00, 19.71s/it, est. speed input: 113.24 toks/s, output: 13.55 toks/s]
Prolog output: B
Completed sample logical_deduction_1049 (iteration 298) for method prolog
Processing sample logical_deduction_1047 (iteration 299) for method prolog
Generating without LoRA
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.58s/it, est. speed input: 108.54 toks/s, output: 13.55 toks/s]Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:20<00:00, 20.58s/it, est. speed input: 108.54 toks/s, output: 13.55 toks/s]
Prolog output: B
Completed sample logical_deduction_1047 (iteration 299) for method prolog
Completed method: prolog
Results saved to results_text_files/results_experiment_0.txt
Dataset composition:
  3-option problems: 60 (20.0%)
  5-option problems: 100 (33.3%)
  7-option problems: 140 (46.7%)

=== OVERALL PERFORMANCE ===

--- prolog_answer ---
Accuracy: 29.33%
Answer distribution: {'Error (invalid answer)': 61, 'A': 57, 'B': 39, 'C': 31, 'Prolog Error': 30, 'Error processing sample': 30, 'D': 22, 'E': 14, 'G': 9, 'F': 7}

=== PERFORMANCE BY PROBLEM TYPE ===

## 3-option problems ##

--- prolog_answer ---
Accuracy: 75.00%
Answer distribution: {'A': 21, 'C': 19, 'B': 17, 'G': 1, 'Prolog Error': 1, 'Error processing sample': 1}

## 5-option problems ##

--- prolog_answer ---
Accuracy: 22.00%
Answer distribution: {'A': 19, 'Prolog Error': 17, 'Error processing sample': 17, 'B': 12, 'Error (invalid answer)': 11, 'D': 11, 'E': 9, 'C': 4}

## 7-option problems ##

--- prolog_answer ---
Accuracy: 15.00%
Answer distribution: {'Error (invalid answer)': 50, 'A': 17, 'Prolog Error': 12, 'Error processing sample': 12, 'D': 11, 'B': 10, 'G': 8, 'C': 8, 'F': 7, 'E': 5}

=== RETRY ANALYSIS ===
Retried cases: 0
Retry success rate: 0.00%
Average retries for success: 0.00

=== FIX ANALYSIS ===
Fixed cases: 0
Fix success rate: 0.00%

=== BACKUP ANALYSIS ===
Used-backup cases: 0
Backup success rate: 0.00%

=== VALID-ONLY (NO ERROR) PERFORMANCE ===

--- prolog_answer (valid only) ---
Accuracy: 49.16%
Answer distribution: {'A': 57, 'B': 39, 'C': 31, 'D': 22, 'E': 14, 'G': 9, 'F': 7}

###############################################################################
HÃ¡brÃ³k Cluster
Job 17939524 for user s5112583
Finished at: Tue Jun 17 08:00:04 CEST 2025

Job details:
============

Job ID                         : 17939524
Name                           : exp0_8B_job
User                           : s5112583
Partition                      : gpumedium
Nodes                          : a100gpu3
Number of Nodes                : 1
Cores                          : 8
Number of Tasks                : 1
State                          : COMPLETED  
Submit                         : 2025-06-16T22:16:34
Start                          : 2025-06-17T04:38:28
End                            : 2025-06-17T08:00:00
Reserved walltime              : 05:00:00
Used walltime                  : 03:21:32
Used CPU time                  : 03:16:32 (Efficiency: 12.19%)
% User (Computation)           : 99.41%
% System (I/O)                 :  0.59%
Total memory reserved          : 62.50G
Maximum memory used            : 2.08G
Requested GPUs                 : a100=1
Allocated GPUs                 : a100=1
Max GPU utilization            : 56%
Max GPU memory used            : 23.53G
Hints and tips      :
 1) You requested much more CPU memory than your program used.
    Please reduce the requested amount of memory.
 *) For more information on these issues see:
    https://wiki.hpc.rug.nl/habrok/additional_information/job_hints

Acknowledgements:
=================

Please see this page for information about acknowledging HÃ¡brÃ³k in your publications:

https://wiki.hpc.rug.nl/habrok/introduction/scientific_output

################################################################################
